---
layout: post
category: 数据分析
title: 常用账期变量
tag: []
excerpt: 常用账期变量。
---

## 常用账期变量

| 编码 | 描述 | 代码 |
| --- | --- | --- |
| ARG_MONTH_DAYS | 传入的数据日期的前一天天数 | SELECT EXTRACT(DAY FROM (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '1 day'))::TEXT |
| ARG_OPTIME_LAST2DAY_ISO | 传入的数据日期的两天前yyyy-mm-dd格式的数据日期 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '2 days'), 'YYYY-MM-DD' ) |
| ARG_OPTIME_LAST2MON_ISO | 传入的数据日期的上2月同期日期yyyy-mm-dd格式的数据日期 | SELECT CASE WHEN CAST(SUBSTRING('${taskid}' FROM 5 FOR 2) AS INTEGER) = 1 THEN (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 8), 'YYYYMMDD') - INTERVAL '2 months')::DATE WHEN ABS(CAST(SUBSTRING('${taskid}' FROM 5 FOR 2) AS INTEGER) - 2) % 12 IN (2, 4, 6, 9, 11) THEN (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 8), 'YYYYMMDD') - INTERVAL '2 months')::DATE ELSE (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 8), 'YYYYMMDD') - INTERVAL '2 months 1 day' + INTERVAL '1 day')::DATE END; |
| ARG_OPTIME_LAST2_MEND | 传入的数据日期的上两个月最后一天yyyymmdd格式的数据日期 | SELECT TO_CHAR(LAST_DAY(TO_DATE(SUBSTRING('${taskid}', 1, 6) |
| ARG_OPTIME_LAST3DAY_ISO | 传入的数据日期的三天前yyyy-mm-dd格式的数据日期 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '3 days'), 'YYYY-MM-DD' ) |
| ARG_OPTIME_LAST3MON | 传入的数据日期的上3月yyyymm格式的数据日期 | SELECT to_char(to_date(substring('${taskid}',1,8), 'YYYY-MM-DD') - interval '3 month', 'YYYYMMDD') |
| ARG_OPTIME_LAST3MON_ISO | 传入的数据日期的上3月同期日期yyyy-mm-dd格式的数据日期 | SELECT to_char(to_date(substring('${taskid}',1,8), 'YYYY-MM-DD') - interval '3 month', 'YYYYMMDD') |
| ARG_OPTIME_LAST3_MEND | 传入的数据日期的上三个月最后一天yyyymmdd格式的数据日期 | SELECT TO_CHAR(LAST_DAY(TO_DATE(SUBSTRING('${taskid}', 1, 6) |
| ARG_OPTIME_LAST3_MEND_ISO | 传入的数据日期的上三个月最后一天yyyy-mm-dd格式的数据日期 | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| ARG_OPTIME_LAST7DAY_ISO | 传入的数据日期的七天前yyyy-mm-dd格式的数据日期 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '7 days'), 'YYYY-MM-DD' ) |
| ARG_OPTIME_LAST8DAY_ISO | 传入的数据日期的八天前yyyy-mm-dd格式的数据日期 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '8 days'), 'YYYY-MM-DD' ) |
| ARG_OPTIME_LAST14DAY_ISO | 传入的数据日期的14天前yyyy-mm-dd格式的数据日期 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '14 days'), 'YYYY-MM-DD' ) |
| ARG_OPTIME_LASTMONFIRSTDAY | 传入的数据日期的前一天所在月份月初yyyymmdd格式的数据日期 | SELECT CONCAT( SUBSTRING( TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '1 day'), 'YYYYMMDD' ), 1, 6), '01' ) |
| ARG_OPTIME_LASTMONFIRSTDAY_ISO | 传入的数据日期的前一天所在月份月初yyyy-mm-dd格式的数据日期 | SELECT CONCAT( SUBSTRING( TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '1 day'), 'YYYY-MM-DD' ), 1, 7), '-01'); |
| ARG_OPTIME_LASTMON_ISO | 传入的数据日期的上月同期日期yyyy-mm-dd格式的数据日期 | SELECT CASE WHEN CASE WHEN SUBSTRING('${taskid}' FROM 5 FOR 2) = '01' THEN 0 ELSE ABS(MOD(CAST(SUBSTRING('${taskid}' FROM 5 FOR 2) AS INTEGER) - 2, 12)) END IN (2, 4, 6, 9, 11) THEN (CAST(SUBSTRING('${taskid}' FROM 1 FOR 8) AS DATE) - INTERVAL '1 month')::DATE ELSE (CAST(SUBSTRING('${taskid}' FROM 1 FOR 8) AS DATE) - INTERVAL '1 day' - INTERVAL '1 month' + INTERVAL '1 day')::DATE END AS formatted_date |
| ARG_OPTIME_LASTYEAR | 前一年的今天 | SELECT TO_CHAR( TO_DATE(substring('${taskid}',1,8), 'YYYYMMDD') - INTERVAL '1 year', 'YYYYMMDD' ) AS previous_year_today_date; |
| ARG_OPTIME_LASTYEARMON_ISO | 传入的数据日期的去年同月yyyy-mm格式的数据日期 | SELECT to_char( (CAST(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 6), '01') AS DATE) - INTERVAL '1 year')::DATE, 'YYYY-MM' ) AS formatted_date |
| ARG_OPTIME_LASTYEAR_ISO | 传入的数据日期的去年同期日期yyyy-mm-dd格式的数据日期 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '1 year'), 'YYYY-MM-DD' ) |
| ARG_OPTIME_LAST_M_ISO | 传入的数据日期的前一天所在月份yyyy-mm格式的数据日期 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '1 day'), 'YYYY-MM' ) |
| ARG_OPTIME_MONDAY_ISO | 传入的数据日期所在周的周一日期yyyy-mm-dd格式的数据日期 | SELECT TO_CHAR( (TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - MOD(EXTRACT(DOW FROM TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD')) + 6, 7))::DATE, 'YYYY-MM-DD' ) AS monday_date; |
| ARG_OPTIME_SUNDAY_ISO | 传入的数据日期所在周的周日日期yyyy-mm-dd格式的数据日期 | SELECT TO_CHAR( (TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') + (7 - EXTRACT(DOW FROM TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD'))))::DATE, 'YYYY-MM-DD' ) AS sunday_date; |
| ARG_OPTIME_YEAR12 | 本年最后一天 | SELECT substring('${taskid}', 1, 4) |
| ARG_TODAY_ISO | yyyy-mm-dd hh格式的当前日期 | SELECT SUBSTRING( CASE WHEN LENGTH( '${taskid}' )>= 10 THEN TO_CHAR(TO_TIMESTAMP( SUBSTRING('${taskid}' , 1, 10) |
| CURRENTMON3 | 当月第3天 | SELECT concat(substring('${taskid}', 1, 6), '03'); |
| CURRENTMON4 | 当月第4天 | SELECT concat(substring('${taskid}', 1, 6), '04'); |
| CURRENTMON5 | 当月第5天 | SELECT concat(substring('${taskid}', 1, 6), '05'); |
| CURRENTMON6 | 当月第6天 | SELECT concat(substring('${taskid}', 1, 6), '06'); |
| CURRENTMON7 | 当月第7天 | SELECT concat(substring('${taskid}', 1, 6), '07'); |
| CURRENTMON8 | 当月第8天 | SELECT concat(substring('${taskid}', 1, 6), '08'); |
| CURRENTMON9 | 当月第9天 | SELECT concat(substring('${taskid}', 1, 6), '09'); |
| CURRENTMON10 | 当月第10天 | SELECT concat(substring('${taskid}', 1, 6), '10'); |
| CURRENTMON11 | 当月第11天 | SELECT concat(substring('${taskid}', 1, 6), '11'); |
| CURRENTMON12 | 当月第12天 | SELECT concat(substring('${taskid}', 1, 6), '12'); |
| CURRENTMON13 | 当月第13天 | SELECT concat(substring('${taskid}', 1, 6), '13'); |
| CURRENTMON14 | 当月第14天 | SELECT concat(substring('${taskid}', 1, 6), '14'); |
| CURRENTMON15 | 当月第15天 | SELECT concat(substring('${taskid}', 1, 6), '15'); |
| CURRENTMON16 | 当月第16天 | SELECT concat(substring('${taskid}', 1, 6), '16'); |
| CURRENTMON17 | 当月第17天 | SELECT concat(substring('${taskid}', 1, 6), '17'); |
| CURRENTMON18 | 当月第18天 | SELECT concat(substring('${taskid}', 1, 6), '18'); |
| CURRENTMON19 | 当月第19天 | SELECT concat(substring('${taskid}', 1, 6), '19'); |
| CURRENTMON20 | 当月第20天 | SELECT concat(substring('${taskid}', 1, 6), '20'); |
| CURRENTMON21 | 当月第21天 | SELECT concat(substring('${taskid}', 1, 6), '21'); |
| CURRENTMON22 | 当月第22天 | SELECT concat(substring('${taskid}', 1, 6), '22'); |
| CURRENTMON23 | 当月第23天 | SELECT concat(substring('${taskid}', 1, 6), '23'); |
| CURRENTMON24 | 当月第24天 | SELECT concat(substring('${taskid}', 1, 6), '24'); |
| CURRENTMON25 | 当月第25天 | SELECT concat(substring('${taskid}', 1, 6), '25'); |
| CURRENTMON26 | 当月第26天 | SELECT concat(substring('${taskid}', 1, 6), '26'); |
| CURRENTMON27 | 当月第27天 | SELECT concat(substring('${taskid}', 1, 6), '27'); |
| CURRENTMON28 | 当月第28天 | SELECT concat(substring('${taskid}', 1, 6), '28'); |
| CURRENTMON29 | 当月第29天 | SELECT concat(substring('${taskid}', 1, 6), '29'); |
| CURRENTMON30 | 当月第30天 | SELECT concat(substring('${taskid}', 1, 6), '30'); |
| CURRENTMON31 | 当月第31天 | SELECT concat(substring('${taskid}', 1, 6), '31'); |
| DAYOFTHISMON | 本月当前天数 | SELECT EXTRACT(DAY FROM substring('${taskid}',1,8)::date ) AS days_in_month |
| DAYOFWEEK_D | 当前日是星期几 | SELECT EXTRACT(DOW FROM to_date(substring('${taskid}', 1, 8), 'YYYYMMDD')) AS weekday; |
| DYASOFONEMONTH | 当月天数 | SELECT EXTRACT(DAY FROM LAST_DAY(TO_DATE(SUBSTRING('${taskid}', 1, 6) |
| DYASOFONEYEAR | 当年天数 | SELECT to_char(to_date(concat(substring('${taskid}', 1, 4), '-12-31'), 'YYYY-MM-DD'), 'DDD') AS day_of_year; |
| Day4WeeksAgo | 4周前(yyyymmdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '28 days', 'YYYYMMDD'); |
| FIRSTDHOUR_H | 当前日第一个小时 | SELECT substring('${taskid}', 1, 8) |
| FIRSTMHOUR_M | 当月第一小时 | SELECT substring('${taskid}', 1, 6) |
| FSTENTIREWK_FRI | 本月第一个完整周的周五日期 | SELECT ( CASE WHEN EXTRACT(DOW FROM date_trunc('month', to_timestamp(substring('${taskid}', 1, 6) |
| FSTENTIREWK_THU | 本月第一个完整周，周四 | SELECT ( CASE WHEN EXTRACT(DOW FROM date_trunc('month', to_timestamp(substring('${taskid}', 1, 6) |
| FSTENTIREWK_WED | 本月第一个完整周，周三 | SELECT CASE WHEN extract(DOW FROM concat(substring('${taskid}', 1, 6), '01')::date) + 1 < 3 THEN to_char(concat(substring('${taskid}', 1, 6), '01')::date + interval '4' - (extract(DOW FROM concat(substring('${taskid}', 1, 6), '01')::date) + 1) * interval '1 day', 'YYYYMMDD') WHEN extract(DOW FROM concat(substring('${taskid}', 1, 6), '01')::date) + 1 >= 3 THEN to_char(concat(substring('${taskid}', 1, 6), '01')::date + interval '11' - (extract(DOW FROM concat(substring('${taskid}', 1, 6), '01')::date) + 1) * interval '1 day', 'YYYYMMDD')END AS result; |
| L6MONLASTDAY | 6最后一天 | SELECT TO_CHAR(LAST_DAY(TO_DATE(SUBSTRING('${taskid}',1,6) |
| LAST2YEARLASTDAY | 前两年最后一天 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 4), '-12-31'), 'YYYY-MM-DD') - interval '2 years')::date, 'YYYYMMDD' ) |
| LASTHOUR_D | 当天最后一个小时 | SELECT substring('${taskid}', 1, 8) |
| LASTMDAY_D | 当前月最后一天 | SELECT TO_CHAR( LAST_DAY(TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD')), 'YYYYMMDD' ); |
| LASTMONDAY | 上月当日 | SELECT TO_CHAR(DATE_TRUNC('day', TIMESTAMP '${taskid?substring(0,8)}' - INTERVAL '1 month'), 'YYYYMMDD') AS last_month_same_day; |
| LASTMONLASTDAY | 上月当日的前一日 | SELECT TO_CHAR( TO_DATE('${taskid}', 'YYYYMMDDHH24MISS') - INTERVAL '1 month' - INTERVAL '1 day', 'YYYYMMDD' ) AS previous_previous_month_date; |
| LASTMON_TOW_BIT | 当前月的上一月取月份 | SELECT TO_CHAR(SUBSTRING('${taskid}', 1, 8)::date - INTERVAL '1 month', 'MM') ; |
| LASTYEARFIRSTDAY | 前一年第一天 | SELECT concat( to_char(date_trunc('year', to_date(substring('${taskid}', 1, 8), 'YYYYMMDD')) - interval '1 year', 'YYYY'), '0101' ) |
| LMONLAST2DAY | 上月倒数第二天 | SELECT to_char( to_date(concat(substring('${taskid}' FROM 1 FOR 6), '01'), 'YYYYMMDD') - interval '2 days', 'YYYYMMDD' ) AS formatted_date; |
| LMONLASTDAY | 上月最后一天 | SELECT TO_CHAR(LAST_DAY(TO_DATE(SUBSTRING('${taskid}', 1, 6) |
| MONOFPRE5YEAR_M | 前五年当月 | SELECT to_char(date_trunc('month', (to_date(concat(substring('${taskid}', 1, 6), '10'), 'YYYYMMDD') - interval '5 years')), 'YYYYMM') AS five_years_ago_month ; |
| Monday | 当前时间的周一(yyyy-mm-dd) | SELECT TO_CHAR(TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD') - CAST(EXTRACT(DOW FROM TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD')) AS INT) + 1, 'YYYY-MM-DD') AS this_monday; |
| MonthfirstDatePre1 | 本月一号减一天 | SELECT (to_date(SUBSTRING('${taskid}', 1, 6) |
| MonthfirstDatePre2 | 本月一号减二天 | SELECT (to_date(SUBSTRING('${taskid}', 1, 6) |
| MonthfirstDatePre3 | 本月一号减三天 | SELECT (to_date(SUBSTRING('${taskid}', 1, 6) |
| MonthfirstDatePre4 | 本月一号减四天 | SELECT (to_date(SUBSTRING('${taskid}', 1, 6) |
| MonthfirstDate_Pre4 | 本月一号减四天(ymd) | SELECT to_char( (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '4 DAY')::DATE ,'YYYYMMDD')AS calculated_date; |
| NEXT2DAY | 后二日 | SELECT TO_CHAR( (date_trunc('day', TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD')) + INTERVAL '2 days'), 'YYYYMMDD' ); |
| NEXT2MONTH_M | 后二月 | SELECT to_char( (to_timestamp(concat(substring('${taskid}', 1, 6), '01'), 'YYYYMMDD') + interval '2 months' + interval '10 day'), 'YYYYMM' ) |
| NEXT3DAY | 后三日 | SELECT TO_CHAR( (date_trunc('day', TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD')) + INTERVAL '3 days'), 'YYYYMMDD' ); |
| NEXT3MONTH_D | 后三月 | SELECT to_char( (to_timestamp(concat(substring('${taskid}', 1, 6), '01'), 'YYYYMMDD') + interval '3 months' + interval '10 day'), 'YYYYMM' ) |
| NEXT6MDAY_D | 六个月后的今天 | SELECT TO_CHAR(TO_DATE(SUBSTRING('${taskid}',1,8), 'YYYYMMDD') + INTERVAL '6 months', 'YYYYMMDD') |
| NEXT7DAY | 后七日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') + INTERVAL '7 days'), 'YYYYMMDD' ); |
| NEXTLASTMDATE_M | 后2月最后一天的日期 | SELECT TO_CHAR(LAST_DAY(TO_DATE(SUBSTRING('${taskid}', 1, 6) |
| NEXTSECONDMDAY_M | 后一月第二天 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 6), '02'), 'YYYYMMDD') + interval '1 month'), 'YYYYMMDD' ) |
| NEXTTHIRDMDAY_M | 后一月第三天 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 6), '03'), 'YYYYMMDD') + interval '1 month'), 'YYYYMMDD' ) |
| NEXTYPREM_LASTDAY | 下一年本月最后一天 | SELECT to_char( last_day( (to_date(concat(substring('${taskid}', 1, 6), '-01'), 'YYYYMM-DD') + INTERVAL '1 year')::date ), 'YYYYMMDD' ) |
| NEXTYTHISM_LASTDAY | 下一年上一月最后一天 | SELECT to_char( last_day( (to_date(concat(substring('${taskid}', 1, 6), '-01'), 'YYYYMM-DD') + INTERVAL '11 months')::date ), 'YYYYMMDD' ) |
| NFLAST60DAY_M | 次月第一天的后六十日 | SELECT to_char( date_trunc('month', to_date(substring('${taskid}', 1, 6), 'YYYYMM')) + INTERVAL '1 month' + INTERVAL '60 day', 'YYYYMMDD') AS formatted_date; |
| ONEMON_THISQUARTER | 本季度第一月 | SELECT SUBSTRING('${taskid}' FROM 1 FOR 4) |
| PER1MON_QU | 上季度第一月 | SELECT to_char( (to_date( CONCAT( substring('${taskid}' FROM 1 FOR 4), CASE WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 1 AND 3 THEN '01' WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 4 AND 6 THEN '04' WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 7 AND 9 THEN '07' WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 10 AND 12 THEN '10' END, '01' ), 'YYYYMMDD' )) - INTERVAL '3 months', 'YYYYMM' ) AS formatted_date |
| PER2MON_QU | 上季度第二月 | SELECT TO_CHAR( DATE_TRUNC('month', CAST( CONCAT( SUBSTRING('${taskid}' FROM 1 FOR 4), CASE WHEN CAST(SUBSTRING('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 1 AND 3 THEN '02' WHEN CAST(SUBSTRING('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 4 AND 6 THEN '05' WHEN CAST(SUBSTRING('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 7 AND 9 THEN '08' WHEN CAST(SUBSTRING('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 10 AND 12 THEN '11' END, '01' ) AS DATE ) - INTERVAL '3 months' ), 'YYYYMM' ) AS formatted_date |
| PER3MON_QU | 上季度第三月 | SELECT to_char( (to_date( CONCAT( substring('${taskid}' FROM 1 FOR 4), CASE WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 1 AND 3 THEN '03' -- 第一季度 WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 4 AND 6 THEN '06' -- 第二季度 WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 7 AND 9 THEN '09' -- 第三季度 WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 10 AND 12 THEN '12' -- 第四季度 END ), 'YYYYMMDD' -- 日期格式 ) - INTERVAL '3 months'), 'YYYYMM' ) AS formatted_date; |
| PPER1MON_QU | 上上季度第一月 | SELECT to_char( (to_date( CONCAT( substring('${taskid}' FROM 1 FOR 4), -- 年份 CASE WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 1 AND 3 THEN '01' -- 第一季度 WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 4 AND 6 THEN '04' -- 第二季度 WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 7 AND 9 THEN '07' -- 第三季度 WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 10 AND 12 THEN '10' -- 第四季度 END ), 'YYYYMMDD' -- 日期格式 ) - interval '6 months'), -- 减去6个月 'YYYYMM' -- 输出格式 ) AS formatted_date; |
| PPER2MON_QU | 上上季度第二月 | SELECT to_char( (to_date( CONCAT( substring('${taskid}' FROM 1 FOR 4), -- 年份 CASE WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 1 AND 3 THEN '02' -- 第一季度中间月份 WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 4 AND 6 THEN '05' -- 第二季度中间月份 WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 7 AND 9 THEN '08' -- 第三季度中间月份 WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 10 AND 12 THEN '11' -- 第四季度中间月份 END ), 'YYYYMMDD' -- 日期格式 ) - INTERVAL '6 months'), -- 减去6个月 'YYYYMM' -- 输出格式 ) AS formatted_date; |
| PPER3MON_QU | 上上季度第三月 | SELECT to_char( (to_date( CONCAT( substring('${taskid}' FROM 1 FOR 4), -- 年份 CASE WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 1 AND 3 THEN '03' -- 第一季度开始月份 WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 4 AND 6 THEN '06' -- 第二季度开始月份 WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 7 AND 9 THEN '09' -- 第三季度开始月份 WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 10 AND 12 THEN '12' -- 第四季度开始月份 END ), 'YYYYMMDD' -- 日期格式 ) - INTERVAL '6 months'), -- 减去6个月 'YYYYMM' -- 输出格式 ) AS formatted_date; |
| PRE2MONTH_Day | 上上月当日 | SELECT TO_CHAR( TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '2 month', 'YYYYMMDD' ) AS previous_previous_month_date; |
| PRE2YEARTHISDAY | 前两年当天 | SELECT CASE WHEN SUBSTRING('${taskid}', 5, 2) = '02' AND SUBSTRING('${taskid}', 7, 2) = '29' THEN to_char(last_day(to_date(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - interval '2 years'), 'YYYYMMDD') ELSE to_char(to_date(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - interval '2 years', 'YYYYMMDD') END AS formatted_date; |
| PRE2YEAR_M | 前二年 | SELECT TO_CHAR((TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| PRE3MONTH_DAY_D | 前三月同一日 | SELECT to_char((to_date(substring('${taskid}',1,8), 'YYYYMMDD') - interval '3 months'),'YYYYMMDD') |
| PRE3YEARTHISDAY | 前3年当天 | SELECT TO_CHAR( TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '3 year', 'YYYYMMDD' ) AS previous_year_today_date; |
| PRE3YEAR_M | 前三年 | SELECT TO_CHAR((TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| PRE4DAY | 前四日 | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '4 days', 'YYYYMMDD'); |
| PRE4YEAR_M | 前四年 | SELECT TO_CHAR((TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| PRE5DAY | 前五日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '5 days')::DATE, 'YYYYMMDD' ); |
| PRE5YEAR_M | 前五年 | SELECT TO_CHAR((TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| PRE6DAY | 前六日 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '6 days')::date, 'YYYYMMDD' ); |
| PRE7DAY | 前七日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '7 days')::DATE, 'YYYYMMDD' ); |
| PRE8DAY | 前八日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '8 days')::DATE, 'YYYYMMDD' ); |
| PRE9DAY | 前九日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '9 days')::DATE, 'YYYYMMDD' ); |
| PRE10DAY | 前十日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '10 days')::DATE, 'YYYYMMDD' ); |
| PRE11DAY | 前十一日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '11 days')::DATE, 'YYYYMMDD' ); |
| PRE13DAY | 前十三日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '13 days')::DATE, 'YYYYMMDD' ); |
| PRE13MON_MB | 前十三月月初 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '13 months')::date, 'YYYYMM' ) |
| PRE14DAY | 前十四日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '14 days')::DATE, 'YYYYMMDD' ); |
| PRE15DAY | 当前日前15天 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '15 days')::DATE, 'YYYYMMDD' ); |
| PRE15MONTH_M | 前15月 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 6), '-01'), 'YYYYMM-DD') - INTERVAL '15 months')::date, 'YYYYMM' ) |
| PRE16MONTH_M | 前16月 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 6), '-01'), 'YYYYMM-DD') - INTERVAL '16 months')::date, 'YYYYMM' ) |
| PRE17MONTH_M | 前17月 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 6), '-01'), 'YYYYMM-DD') - INTERVAL '17 months')::date, 'YYYYMM' ) |
| PRE18MONTH_M | 前18月 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 6), '-01'), 'YYYYMM-DD') - INTERVAL '18 months')::date, 'YYYYMM' ) |
| PRE19MONTH_M | 前19月 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 6), '-01'), 'YYYYMM-DD') - INTERVAL '19 months')::date, 'YYYYMM' ) |
| PRE20DAY | 前二十日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '20 days')::DATE, 'YYYYMMDD' ); |
| PRE20MONTH_M | 前20月 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 6), '-01'), 'YYYYMM-DD') - INTERVAL '20 months')::date, 'YYYYMM' ) |
| PRE21DAY | 前二十一日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '21 days')::DATE, 'YYYYMMDD' ); |
| PRE21MONTH_M | 前21月 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 6), '-01'), 'YYYYMM-DD') - INTERVAL '21 months')::date, 'YYYYMM' ) |
| PRE22MONTH_M | 前22月 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 6), '-01'), 'YYYYMM-DD') - INTERVAL '22 months')::date, 'YYYYMM' ) |
| PRE23MONTH_M | 前23月 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 6), '-01'), 'YYYYMM-DD') - INTERVAL '23 months')::date, 'YYYYMM' ) |
| PRE25DAY | 前二十五日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '25 days')::DATE, 'YYYYMMDD' ); |
| PRE26DAY | 前二十六日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '26 days')::DATE, 'YYYYMMDD' ); |
| PRE27DAY | 前二十七日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '27 days')::DATE, 'YYYYMMDD' ); |
| PRE28DAY | 前28日 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '28 days')::date, 'YYYYMMDD' ) |
| PRE29DAY | 前29日 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '29 days')::timestamp, 'YYYYMMDD' ) |
| PRE30DAY | 前30日 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '30 days')::date, 'YYYYMMDD' ) |
| PRE31DAY | 前31日 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '31 days')::date, 'YYYYMMDD' ) |
| PRE34DAY | 前三十四日 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '34 days')::DATE, 'YYYYMMDD' ); |
| PRE35DAY | 前三十五日 | SELECT to_char( (to_timestamp(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '35 days')::date, 'YYYYMMDD' ) |
| PRE41DAY | 前四十一日 | SELECT to_char( (to_timestamp(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '41 days')::date, 'YYYYMMDD' ) |
| PRE48DAY | 前四十八日 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '48 days')::date, 'YYYYMMDD' ) |
| PRE55DAY | 前五十五日 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '55 days')::date, 'YYYYMMDD' ) |
| PRE60DAY | 前六十日 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '60 days')::date, 'YYYYMMDD' ) |
| PRE63DAY | 前六十三日 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '63 days')::date, 'YYYYMMDD' ) |
| PRE90DAY | 本月最后一日的前九十日 | SELECT TO_CHAR( last_day(CONCAT(SUBSTRING('${taskid}', 1, 6), '01')) - INTERVAL '90 days', 'YYYYMMDD' ); |
| PRE120DAY | 前120天 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '120 days')::date, 'YYYYMMDD' ) |
| PRE150DAY | 前一百五十日 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '150 days')::date, 'YYYYMMDD' ) |
| PRE180DAY | 前一百八十日 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '180 days')::date, 'YYYYMMDD' ) |
| PRE365DAY | 前365天 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '365 days')::date, 'YYYYMMDD' ) |
| PREDAYHOUR | 前一天同一小时 | SELECT TO_CHAR((TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 8), 'YYYYMMDD') - INTERVAL '1 day'), 'YYYYMMDD') |
| PREMONDAY | 本日的前本月天数的日期 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - (SUBSTRING(TO_CHAR( LAST_DAY(TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD')), 'YYYYMMDD' ), 7, 2))::INTEGER * INTERVAL '1 day')::DATE, 'YYYYMMDD') AS adjusted_date; |
| PREYEARFIRSTMON_M | 前一年第一个月 | SELECT to_char(date_trunc('month', (to_date(concat(substring('${taskid}', 1, 4), '0101'), 'YYYYMMDD') - interval '1 year')), 'YYYYMM') AS one_year_ago_month ; |
| PREYEAR_DAY_M | 前12月最后一天 | SELECT TO_CHAR(LAST_DAY(TO_DATE(SUBSTRING('${taskid}', 1, 6) |
| PREYEAR_MON_FIRSTMD | 前一年的当月第一天 | SELECT to_char(date_trunc('MONTH', to_timestamp(concat(substring('${taskid}', 1, 6), '01'), 'YYYYMMDD') - interval '1 year'), 'YYYYMMDD') |
| PREYEAR_PREMON_D | 前一年上个月 | SELECT to_char( (to_date(concat(substring('${taskid}', 1, 6), '10'), 'YYYYMMDD') - interval '13 months')::date, 'YYYYMM' ) |
| PREY_PREM_LASTDAY | 前一年上个月最后一天 | SELECT to_char(last_day(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '13 months'), 'YYYYMMDD') AS last_day_of_previous_month ; |
| PRE_DAY | 前一日是当月第几天 | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '1 day'), 'DD' ) |
| Pre2monthfirstDatePre1 | 前两月一号减一天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '2 MONTHS' - INTERVAL '1 DAY')::DATE AS calculated_date; |
| Pre2monthfirstDatePre2 | 前两月一号减二天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '2 MONTHS 2 DAYS')::DATE AS calculated_date; |
| Pre2monthfirstDatePre3 | 前两月一号减三天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '2 MONTHS 3 DAYS')::DATE AS calculated_date; |
| Pre2monthfirstDatePre4 | 前两月一号减四天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '2 MONTHS 4 DAYS')::DATE AS calculated_date; |
| Pre2monthfirstDay | 前两月一号(y-m-d) | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '2 MONTHS')::DATE AS calculated_date; |
| Pre3monthfirstDatePre1 | 前三月一号减一天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '3 MONTHS 1 DAY')::DATE AS calculated_date; |
| Pre3monthfirstDatePre2 | 前三月一号减二天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '3 MONTHS 2 DAYS')::DATE AS calculated_date; |
| Pre3monthfirstDatePre3 | 前三月一号减三天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '3 MONTHS 3 DAYS')::DATE AS calculated_date; |
| Pre3monthfirstDatePre4 | 前三月一号减四天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '3 MONTHS 4 DAYS')::DATE AS calculated_date; |
| Pre4monthfirstDatePre1 | 前四月一号减一天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '4 MONTHS 1 DAY')::DATE AS calculated_date; |
| Pre4monthfirstDatePre2 | 前四月一号减二天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '4 MONTHS 2 DAYS')::DATE AS calculated_date; |
| Pre4monthfirstDatePre3 | 前四月一号减三天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '4 MONTHS 3 DAYS')::DATE AS calculated_date; |
| Pre4monthfirstDatePre4 | 前四月一号减四天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '4 MONTHS 4 DAYS')::DATE AS calculated_date; |
| Pre5monthfirstDatePre1 | 前五月一号减一天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '5 MONTHS 1 DAY')::DATE AS calculated_date; |
| Pre5monthfirstDatePre2 | 前五月一号减二天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '5 MONTHS 2 DAYS')::DATE AS calculated_date; |
| Pre5monthfirstDatePre3 | 前五月一号减三天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '5 MONTHS 3 DAYS')::DATE AS calculated_date; |
| Pre5monthfirstDatePre4 | 前五月一号减四天 | SELECT (TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '5 MONTHS 4 DAYS')::DATE AS calculated_date; |
| PremonthfirstDatePre1 | 前一月一号减一天 | SELECT (date_trunc('month', TO_DATE(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD')) - INTERVAL '1 MONTH 1 DAY')::DATE AS calculated_date; |
| PremonthfirstDatePre2 | 前一月一号减二天 | SELECT (to_date(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '1 MONTH 2 DAYS')::DATE AS calculated_date; |
| PremonthfirstDatePre3 | 前一月一号减三天 | SELECT (to_date(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '1 MONTH 3 DAYS')::DATE AS calculated_date; |
| PremonthfirstDatePre4 | 前一月一号减四天 | SELECT (to_date(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '1 MONTH 4 DAYS')::DATE AS calculated_date; |
| Q3MONFRISTDAY | 前3月第一天 | SELECT TO_CHAR(DATE_TRUNC('month', TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| Q5MONLASTDAY | 前5月最后一天 | SELECT TO_CHAR(LAST_DAY(TO_DATE(SUBSTRING('${taskid}', 1, 6) |
| SECONDMDAY_M | 当前月第二天 | SELECT concat(substring('${taskid}', 1, 6), '02'); |
| THEMON_PRE2DAY | 前二日所在月份 | SELECT TO_CHAR(TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '2 days', 'YYYYMM'); |
| THEMON_PRE3DAY | 前三日所在月份 | SELECT TO_CHAR(TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '3 days', 'YYYYMM'); |
| THIS90DAY | 当前日前90天 | SELECT to_char( (to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '90 days')::date, 'YYYYMMDD' ) |
| THISMIN | 当前分钟 | SELECT EXTRACT(MINUTE FROM CURRENT_TIME) AS current_minute; |
| THISMMSDAY | 日通报彩信今日格式 | SELECT SUBSTRING('${taskid}' FROM 5 FOR 2) |
| THISMONDAYISO | 当前日的本周一 | SELECT TO_CHAR(TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD') - CAST(EXTRACT(DOW FROM TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD')) AS INT) + 1, 'YYYYMMDD') AS this_monday; |
| THISPREMONNO10 | 上月10日 | SELECT TO_CHAR( (TO_DATE(concat(substring('${taskid}', 1, 6), '10'), 'YYYYMMDD') - INTERVAL '1 month')::DATE, 'YYYYMMDD' ) |
| THISSECOND | 当前秒 | SELECT EXTRACT(SECOND FROM current_timestamp)::int AS current_second; |
| THISSUNDAYISO | 当前日的本周日 | SELECT TO_CHAR( (TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - MOD(EXTRACT(DOW FROM TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD')) - 7, 7))::DATE, 'YYYYMMDD' ) AS monday_date; |
| THISTIME | 当前时间 | SELECT to_char(CURRENT_TIMESTAMP, 'YYYYMMDDHH24MISS') AS formatted_current_timestamp; |
| THISWEEKNO | 判断今天是星期几 | SELECT EXTRACT(DOW FROM to_date(substring('${taskid}', 1, 8), 'YYYYMMDD')) AS weekday; |
| THIS_QU_FIRST_DATE | 当前季度第一天日期 | SELECT TO_CHAR(TO_DATE(SUBSTRING('${taskid}', 1, 4) |
| THIS_QU_FIRST_DAY | 当前季度第一天 | SELECT TO_CHAR(TO_DATE(SUBSTRING('${taskid}', 1, 4) |
| THRMON_THISQUARTER | 本季度第三月 | SELECT SUBSTRING('${taskid}' FROM 1 FOR 4) |
| TWOMON_THISQUARTER | 本季度第二月 | SELECT SUBSTRING('${taskid}' FROM 1 FOR 4) |
| YEARAPRMON_C | 当年四月 | SELECT concat(substring('${taskid}', 1, 4), '04') |
| YEARAUGMON_C | 当年八月 | SELECT concat(substring('${taskid}', 1, 4), '08') |
| YEARJULMON_C | 当年七月 | SELECT concat(substring('${taskid}', 1, 4), '07') |
| YEARJUNMON_C | 当年六月 | SELECT concat(substring('${taskid}', 1, 4), '06') |
| YEARLAST2MON_P | 上年末2月 | SELECT to_char(date_trunc('month', (to_date(concat(substring('${taskid}', 1, 4), '1101'), 'YYYYMMDD') - interval '1 year')), 'YYYYMM') AS one_year_ago_month ; |
| YEARLAST3MON_P | 上年末3月 | SELECT to_char(date_trunc('month', (to_date(concat(substring('${taskid}', 1, 4), '1001'), 'YYYYMMDD') - interval '1 year')), 'YYYYMM') AS one_year_ago_month ; |
| YEARLASTMON_C | 当年最后一个月 | SELECT concat(substring('${taskid}', 1, 4), '12') |
| YEARLASTMON_P2 | 上上年末月 | SELECT CONCAT(TO_CHAR((TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| YEARMARMON_C | 当年三月 | SELECT concat(substring('${taskid}', 1, 4), '03') |
| YEARMAYMON_C | 当年五月 | SELECT concat(substring('${taskid}', 1, 4), '05') |
| YEARNOVMON_C | 当年十一月 | SELECT substring('${taskid}', 1, 4) |
| YEAROCTMON_C | 当年十月 | SELECT substring('${taskid}', 1, 4) |
| YEARSECONDMON_C | 当年二月 | SELECT concat(substring('${taskid}', 1, 4), '02') |
| YEARSEPMON_C | 当年九月 | SELECT substring('${taskid}', 1, 4) |
| a3dayid | 后3个月日期(yyyy-MM-dd) | SELECT (to_date('${taskid?substring(0,8)}', 'YYYYMMDD') + INTERVAL '3 month')::date; |
| after15mi | 运行批次后15分钟(YYYYmmddhhMMss) | SELECT CASE WHEN LENGTH('${taskid}') = 6 THEN TO_CHAR(TO_TIMESTAMP(SUBSTRING('${taskid}' |
| aftermonth_beginday | 下月1日(YYYY-MM-DD) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| aftermonthbeginday | 下月1日(YYYYMMDD) | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| aftermonthyyyymm | 数据日期下月的年月(YYYYMM) | SELECT REPLACE(SUBSTRING((DATE_TRUNC('MONTH', TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') + INTERVAL '1 MONTH')::text), 1, 7), '-', ''); |
| before_last_month_first2 | 前两个月一号(yyyy-mm-dd),用于月调度 | SELECT TO_CHAR((TO_DATE(substring('${taskid}',1,8), 'YYYY-MM-DD') - INTERVAL '2 months'), 'YYYY-MM-01') |
| before_last_month_first | 前两个月一号(yyyy-mm-dd) | SELECT TO_CHAR((TO_DATE(substring('${taskid}',1,8), 'YYYY-MM-DD') - INTERVAL '2 months'), 'YYYY-MM-01') |
| beforelastmonthfirst | 前两个月一号(yyyymmdd) | SELECT to_char(date_trunc('month', to_date(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '2 months')::date, 'YYYYMMDD') |
| beforelastyearcurday | 前年同期(yyyMMdd) | SELECT to_char((to_date('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '2 year')::date, 'YYYYMMDD') AS new_date; |
| curYearFirstD | 本年的第一天(yyyymmdd) | SELECT TO_CHAR(TO_DATE(SUBSTRING('${taskid?substring(0,8)}' FROM 1 FOR 4) |
| cur_dd | 当前天数 | ${taskid?substring(6,8)} |
| curday | 今天日期yyyy-mm-dd | SELECT TO_CHAR( TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') + INTERVAL '1 day', 'YYYY-MM-DD' ) AS previous_year_today_date; |
| curm_first_day | 本月一号(y-m-d) | SELECT (to_date(SUBSTRING('${taskid}', 1, 6) |
| curm_last_day | 本月最后一天(y-m-d) | SELECT CASE WHEN LENGTH('${taskid}') = 6 THEN TO_CHAR(LAST_DAY(TO_DATE('${taskid}'|
| curm_p1last_day | 本月最后一天减一天(y-m-d) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE)) + INTERVAL '1 month' - INTERVAL '2 day'), 'YYYY-MM-DD'); |
| curm_p2last_day | 本月最后一天减两天(y-m-d) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE)) + INTERVAL '1 month' - INTERVAL '3 day'), 'YYYY-MM-DD'); |
| curm_p3last_day | 本月最后一天减三天(y-m-d) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE)) + INTERVAL '1 month' - INTERVAL '4 day'), 'YYYY-MM-DD'); |
| curmdays | 当前月的总天数 | SELECT CASE WHEN LENGTH('${taskid}') = 6 THEN EXTRACT(DAY FROM LAST_DAY(TO_DATE(CONCAT('${taskid}', '01'), 'YYYYMM'))) WHEN LENGTH('${taskid}') = 8 THEN EXTRACT(DAY FROM LAST_DAY(TO_DATE('${taskid}', 'YYYYMMDD'))) END |
| curmfifteenday | 本月十五号(ymd) | ${taskid?substring(0,6)}15 |
| curmfirstday | 本月一号(ymd) | ${taskid?substring(0,6)}01 |
| curmfourday | 本月四号(ymd) | ${taskid?substring(0,6)}04 |
| curmlastday | 本月最后一天(ymd) | SELECT CASE WHEN CHAR_LENGTH(${taskid}) = 6 THEN TO_CHAR(LAST_DAY(TO_DATE('${taskid}01', 'YYYYMMDD')), 'YYYYMMDD') ELSE TO_CHAR(LAST_DAY(TO_DATE(substring('${taskid}',1,8), 'YYYYMMDD')), 'YYYYMMDD') END AS last_day_result; |
| curmsecondday | 本月二号(ymd) | ${taskid?substring(0,6)}02 |
| curmthirdday | 本月三号(ymd) | ${taskid?substring(0,6)}03 |
| curr_timestamp | 当时时间，格式：yyyy-mm-dd hh24:mi:ss | SELECT TO_CHAR(CURRENT_TIMESTAMP, 'YYYY-MM-DD HH24:MI:SS') |
| curw_first_day | 当前周第一天（y-d-m） | SELECT TO_CHAR( (TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - MOD(EXTRACT(DOW FROM TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD')) + 7, 7))::DATE, 'YYYY-MM-DD' ) AS monday_date; |
| cury_first_day | 当年第一天(y-m-d) | SELECT TO_CHAR(TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 4) |
| curyfirstday | 当年第一天(ymd) | ${taskid?substring(0,4)}0101 |
| curyfirstmonth | 当前年第一个月(yyyymm) | ${taskid?substring(0,4)}01 |
| curylastmonth | 当前年最后一个月 | ${taskid?substring(0,4)}12 |
| cycle_firstday | 变量值 = 当前日期 - （当前月天数 - 1）(yyyymmdd) | select to_char(substring('${taskid}',1,8)::date + EXTRACT(DAY FROM age('${taskid?substring(0,6)}01'::date ,last_day(substring('${taskid}',1,8)::date))),'YYYYMMDD') AS VAR_VAL; |
| d_taskid | 数据日期的1号(YYYY-MM-01) | SELECT SUBSTRING('${'${taskid}'}01' FROM 1 FOR 4) |
| day | 当前批次日期的日_dd | SELECT SUBSTRING('${taskid}'::VARCHAR, 7, 2); |
| day_dd | 日期截取（dd） | SELECT SUBSTRING('${taskid}' FROM 7 FOR 2); |
| day_id | 当前日期（y-m-d） | ${taskid?substring(0,8)?calDate(0,'d','yyyy-MM-dd')} |
| day_of_week | 当前日期是周几 | SELECT EXTRACT(DOW FROM to_date(substring('${taskid}', 1, 8), 'YYYYMMDD')) AS weekday; |
| dayid | 当前日期(ymd) | ${taskid?substring(0,8)} |
| dayid_h | 当前小时(yyyy-MM-dd HH) | SELECT SUBSTRING( CASE WHEN LENGTH(REPLACE('${taskid}', '-', '')) >= 10 THEN TO_TIMESTAMP(SUBSTRING(REPLACE('${taskid}', '-', '') |
| dayid_last_day | 当前日期所在月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE)) + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| dayid_month | 当前日期所在月份(yyyy-MM) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE)) + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM'); |
| dayidh | 当前小时(yyyyMMddHH) | SELECT CASE WHEN LENGTH(REPLACE('${taskid}', '-', '')) >= 10 THEN SUBSTRING(REPLACE('${taskid}', '-', ''), 1, 10) ELSE '传参' END; |
| dayidlastday | 当前日期所在月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE)) + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| dayidmonth | 当前日期所在月份(yyyyMM) | SELECT SUBSTR('${taskid}', 1, 6); |
| days | 当月天数 | ${taskid?calDate(0,'L','yyyyMMdd')?substring(6,8)} |
| dd | 数据日期的天(DD) | SELECT SUBSTR('${taskid}', 7, 2); |
| ds_curm_firstday | 当月一号(如：2014-08-01) | ${taskid?calDate(0,'M','yyyy-MM')}-01 |
| ds_curmlastday | 当月最后一天(yyyy-MM-dd) | ${taskid?calDate(0,'L')?calDate(0,'D','yyyy-MM-dd')} |
| ds_l2d_taskid | 当前批次前2天(YYYY-MM-DD) | ${taskid?calDate(-2,'D','yyyy-MM-dd')} |
| ds_l2m_taskid | 日批次对应上2月同期日（yyyy-mm-dd） | ${taskid?calDate(-2,'M','yyyy-MM-dd')} |
| ds_l3d_taskid | 日批次前3天（yyyy-mm-dd） | ${taskid?calDate(-3,'D','yyyy-MM-dd')} |
| ds_l3m_taskid | 三月前当天（yyyy-mm-dd） | ${taskid?calDate(-3,'M','yyyy-MM-dd')} |
| ds_l4m_taskid | 日批次对应上4月同期日（yyyy-mm-dd） | ${taskid?calDate(-4,'M','yyyy-MM-dd')} |
| ds_l5m_taskid | 日批次对应上5月同期日（yyyy-mm-dd） | ${taskid?calDate(-5,'M','yyyy-MM-dd')} |
| ds_l6m_01taskid | 六月前1号（yyyy-mm -01） | ${taskid?calDate(-6,'M','yyyy-MM')}-01 |
| ds_l6m_taskid | 六月前当天（yyyy-mm-dd） | ${taskid?calDate(-6,'M','yyyy-MM-dd')} |
| ds_l7m_taskid | 日批次对应上7月同期日（yyyy-mm-dd） | ${taskid?calDate(-7,'M','yyyy-MM-dd')} |
| ds_l8m_taskid | 日批次对应上8月同期日（yyyy-mm-dd） | ${taskid?calDate(-8,'M','yyyy-MM-dd')} |
| ds_l9m_taskid | 日批次对应上9月同期日（yyyy-mm-dd） | ${taskid?calDate(-9,'M','yyyy-MM-dd')} |
| ds_l10m_taskid | 日批次对应上10月同期日（yyyy-mm-dd） | ${taskid?calDate(-10,'M','yyyy-MM-dd')} |
| ds_l11m_taskid | 日批次对应上11月同期日（yyyy-mm-dd） | ${taskid?calDate(-11,'M','yyyy-MM-dd')} |
| ds_ld_taskid | 日批次前一天（YYYY-MM-DD） | ${taskid?calDate(-1,'D','yyyy-MM-dd')} |
| ds_lm_01taskid | 上月1号（yyyy-mm -01） | ${taskid?calDate(-1,'M','yyyy-MM')}-01 |
| ds_lm_mtaskid | 上月批次(yyyy-mm) | ${taskid?calDate(-1,'M','yyyy-MM')} |
| ds_lm_taskid | 日批次对应上月同期日（yyyy-mm-dd） | ${taskid?calDate(-1,'M','yyyy-MM-dd')} |
| ds_ly_mtaskid | 去年同月（yyyy-mm） | ${taskid?calDate(-1,'Y','yyyy-MM')} |
| ds_ly_taskid | 去年同期日（yyyy-mm-dd) | ${taskid?calDate(-1,'Y','yyyy-MM-dd')} |
| ds_lyld_taskid | 去年同期前一天（yyyy-mm-dd） | ${taskid?calDate(-1,'Y')?calDate(-1,'D','yyyy-MM-dd')} |
| ds_m_taskid | 月批次（yyyy-mm） | ${taskid?calDate(0,'M','yyyy-MM')} |
| ds_nd_taskid | 日批次对应后一天（yyyy-mm-dd） | ${taskid?calDate(+1,'D','yyyy-MM-dd')} |
| ds_nm_01taskid | 下月1号（yyyy-mm -01） | ${taskid?calDate(+1,'M','yyyy-MM')}-01 |
| ds_task_id | 当前批次日期(yyyy-mm-dd) | ${taskid?calDate(+0,'D','yyyy-MM-dd')} |
| dtask_id | 日批次 | ${taskid?substring(0,8)} |
| dtaskid2 | 据日期的1号(YYYYMM01) | SELECT SUBSTRING('${taskid}' FOR 6) |
| dtaskid | 适用于非日批次程序使用日批次 | ${taskid?substring(0,8)} |
| etaskid | 当年最后一天（yyyymmdd） | ${taskid?calDate(0,'Y','yyyy')}1231 |
| first2month_year | 数据日期的前2月所在年 | SELECT SUBSTRING( (TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD') - INTERVAL '2 months')::TEXT, 1, 4 ) |
| first3month_year | 数据日期的前3月所在年 | SELECT SUBSTRING( (TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD') - INTERVAL '3 months')::TEXT, 1, 4 ) |
| first6month_day | 数据日期的前6月同期(YYYY-MM-DD) | SELECT (TO_DATE( CONCAT( SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-', SUBSTRING('${taskid}' FROM 7 FOR 2) ), 'YYYY-MM-DD' ) - INTERVAL '6 months')::DATE |
| first6month_year | 数据日期的前6月所在年 | SELECT SUBSTRING( (TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD') - INTERVAL '6 months')::TEXT, 1, 4 ) |
| h_preday | 小时程序使用日前一天 | ${taskid?calDate(-1,'d','yyyyMMdd')} |
| hh | 数据日期的小时（hh） | SELECT SUBSTRING('${taskid}' FROM 9 FOR 10) |
| hh_id24 | 当前批次小时变量1~24(YYYYmmddHH) | SELECT times + 1 FROM ( SELECT CASE WHEN LENGTH('${taskid}') = 6 THEN concat('${taskid}', '0100') WHEN LENGTH('${taskid}') = 8 THEN concat('${taskid}', '00') WHEN LENGTH('${taskid}') = 10 THEN '${taskid}' WHEN LENGTH('${taskid}') = 12 THEN SUBSTRING('${taskid}', 1, 10) END AS times ) aa; |
| hour_id | 当前批次正常小时变量0-23，格式YYYYmmddHH | SELECT times FROM ( SELECT CASE WHEN LENGTH('${taskid}') = 6 THEN concat('${taskid}', '0100') WHEN LENGTH('${taskid}') = 8 THEN concat('${taskid}', '00') WHEN LENGTH('${taskid}') = 10 THEN '${taskid}' WHEN LENGTH('${taskid}') = 12 THEN SUBSTRING('${taskid}', 1, 10) END AS times ) aa; |
| hourhh | 当前小时(hh) | SELECT SUBSTR('${taskid}', 9, 2); |
| hourhhpre1 | 当前小时的前一个小时(yyyymmddhh) | ${taskid?calDate(-1,'h')} |
| hourhhpre2 | 当前小时的前两个小时(yyyymmddhh) | ${taskid?calDate(-2,'h')} |
| hourhhpre3 | 当前小时的前三个小时(hh) | SELECT TO_CHAR(TO_TIMESTAMP(SUBSTRING('${taskid}', 1, 10) |
| hourhhpre_3 | 当前小时的前三个小时(yyyymmddhh) | ${taskid?calDate(-3,'h')} |
| hourhhpre_4 | 当前小时的前四个小时(yyyymmddhh) | ${taskid?calDate(-4,'h')} |
| hourhhpre_5 | 当前小时的前五个小时(yyyymmddhh) | ${taskid?calDate(-5,'h')} |
| hourhhpre_6 | 当前小时的前六个小时(yyyymmddhh) | ${taskid?calDate(-6,'h')} |
| hourhhpre_7 | 当前小时的前七个小时(yyyymmddhh) | ${taskid?calDate(-7,'h')} |
| hourhhpre_8 | 当前小时的前八个小时(yyyymmddhh) | ${taskid?calDate(-8,'h')} |
| hourhhpre_9 | 当前小时的前九个小时(yyyymmddhh) | ${taskid?calDate(-9,'h')} |
| hourhhpre_10 | 当前小时的前十个小时(yyyymmddhh) | ${taskid?calDate(-10,'h')} |
| hourid | 小时 | ${taskid?calDate(0,'h','yyyyMMddHH')} |
| htask_id | 小时批次 | ${taskid?substring(0,10)} |
| l2d_taskid | 日批次前两天（yyyymmdd） | ${taskid?calDate(-2,'D','yyyyMMdd')} |
| l2m_mm | 上2月批次(mm) | ${taskid?calDate(-2,'M','MM')} |
| l2m_mtaskid | 上2月批次（yyyymm） | ${taskid?calDate(-2,'M','yyyyMM')} |
| l2m_taskid | 上2月批次日期（yyyymmdd） | ${taskid?calDate(-2,'M')} |
| l2mlastday | 前2月最后一天（yyyymmdd） | ${taskid?calDate(-2,'M','yyyyMMdd')?calDate(0,'L')} |
| l2y_lasttaskid | 前年最后一天(yyyymmdd) | ${taskid?calDate(-2,'Y','YYYY')}1231 |
| l2y_mtaskid | 前年同期月yyyymm | ${taskid?calDate(-2,'Y','yyyyMM')} |
| l2y_taskid | 前2年yyyymmdd | ${taskid?calDate(-2,'Y','yyyyMMdd')} |
| l2y_ytaskid | 前2年（yyyy） | ${taskid?calDate(-2,'Y','yyyy')} |
| l2ytaskday | 前年同期(YYYYMMDD) | SELECT to_char((to_date('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '2 year')::date, 'YYYYMM') AS new_date; |
| l3d_taskid | 日批次前3天（yyyymmdd） | ${taskid?calDate(-3,'D','yyyyMMdd')} |
| l3h_hour_id | 前3小时 | ${taskid?calDate(-3,'h','yyyyMMddHH')} |
| l3m_mm | 上3月批次(mm) | ${taskid?calDate(-3,'M','MM')} |
| l3m_mtaskid | 上3月批次（yyyymm） | ${taskid?calDate(-3,'M','yyyyMM')} |
| l3m_taskid | 上3月批次日期（yyyymmdd） | ${taskid?calDate(-3,'M')} |
| l3mlastday | 前3月最后一天（yyyymmdd） | ${taskid?calDate(-3,'M','yyyyMMdd')?calDate(0,'L')} |
| l3y_ytaskid | 前3年（yyyy） | ${taskid?calDate(-3,'Y','yyyy')} |
| l4d_taskid | 批次前4天（yyyymmdd） | ${taskid?calDate(-4,'D')} |
| l4m_mm | 上4月批次(mm) | ${taskid?calDate(-4,'M','MM')} |
| l4m_mtaskid | 上4月批次（yyyymm） | ${taskid?calDate(-4,'M','yyyyMM')} |
| l4m_taskid | 上4月批次日期（yyyymmdd） | ${taskid?calDate(-4,'M')} |
| l4mlastday | 前4月最后一天（yyyymmdd） | ${taskid?calDate(-4,'M','yyyyMMdd')?calDate(0,'L')} |
| l5d_taskid | 批次前5天（yyyymmdd） | ${taskid?calDate(-5,'D')} |
| l5m_mm | 上5月批次(mm) | ${taskid?calDate(-5,'M','MM')} |
| l5m_mtaskid | 上5月批次（yyyymm） | ${taskid?calDate(-5,'M','yyyyMM')} |
| l5m_taskid | 上5月批次日期（yyyymmdd） | ${taskid?calDate(-5,'M')} |
| l5mlastday | 前5月最后一天（yyyymmdd） | ${taskid?calDate(-5,'M','yyyyMMdd')?calDate(0,'L')} |
| l6d_taskid | 批次前6天（yyyymmdd） | ${taskid?calDate(-6)} |
| l6h_hour_id | 前6小时 | ${taskid?calDate(-6,'h','yyyyMMddHH')} |
| l6m_mm | 上6月批次(mm) | ${taskid?calDate(-6,'M','MM')} |
| l6m_mtaskid | 上6月批次（yyyymm） | ${taskid?calDate(-6,'M','yyyyMM')} |
| l6m_taskid | 上6月批次日期（yyyymmdd） | ${taskid?calDate(-6,'M')} |
| l6mlastday | 前6月最后一天（yyyymmdd） | ${taskid?calDate(-6,'M','yyyyMMdd')?calDate(0,'L')} |
| l7d_taskid | 批次对应上周同期日（yyyymmdd） | ${taskid?calDate(-7,'D')} |
| l7m_mm | 上7月批次(mm) | ${taskid?calDate(-7,'M','MM')} |
| l7m_mtaskid | 上7月批次（yyyymm） | ${taskid?calDate(-7,'M','yyyyMM')} |
| l7m_taskid | 上7月批次日期（yyyymmdd） | ${taskid?calDate(-7,'M')} |
| l7mlastday | 前7月最后一天（yyyymmdd） | ${taskid?calDate(-7,'M','yyyyMMdd')?calDate(0,'L')} |
| l8d_taskid | 批次前8天（yyyymmdd） | ${taskid?calDate(-8,'D')} |
| l8m_mm | 上8月批次(mm) | ${taskid?calDate(-8,'M','MM')} |
| l8m_mtaskid | 上8月批次（yyyymm） | ${taskid?calDate(-8,'M','yyyyMM')} |
| l8m_taskid | 上8月批次日期（yyyymmdd） | ${taskid?calDate(-8,'M')} |
| l8mlastday | 前8月最后一天（yyyymmdd） | ${taskid?calDate(-8,'M','yyyyMMdd')?calDate(0,'L')} |
| l9d_taskid | 批次前9天（yyyymmdd） | ${taskid?calDate(-9,'D')} |
| l9m_mm | 上9月批次(mm) | ${taskid?calDate(-9,'M','MM')} |
| l9m_mtaskid | 上9月批次（yyyymm） | ${taskid?calDate(-9,'M','yyyyMM')} |
| l9m_taskid | 上9月批次日期（yyyymmdd） | ${taskid?calDate(-9,'M')} |
| l9mlastday | 前9月最后一天（yyyymmdd） | ${taskid?calDate(-9,'M','yyyyMMdd')?calDate(0,'L')} |
| l10d_taskid | 批次前10天（yyyymmdd） | ${taskid?calDate(-10,'D')} |
| l10m_mm | 上10月批次(mm) | ${taskid?calDate(-10,'M','MM')} |
| l10m_mtaskid | 上10月批次（yyyymm） | ${taskid?calDate(-10,'M','yyyyMM')} |
| l10m_taskid | 上10月批次日期（yyyymmdd） | ${taskid?calDate(-10,'M')} |
| l10mlastday | 前10月最后一天（yyyymmdd） | ${taskid?calDate(-10,'M','yyyyMMdd')?calDate(0,'L')} |
| l11d_taskid | 批次前11天（yyyymmdd） | ${taskid?calDate(-11,'D')} |
| l11m_mm | 上11月批次(mm) | ${taskid?calDate(-11,'M','MM')} |
| l11m_mtaskid | 上11月批次（yyyymm） | ${taskid?calDate(-11,'M','yyyyMM')} |
| l11m_taskid | 上11月批次日期（yyyymmdd） | ${taskid?calDate(-11,'M')} |
| l11mlastday | 前11月最后一天（yyyymmdd） | ${taskid?calDate(-11,'M','yyyyMMdd')?calDate(0,'L')} |
| l12d_taskid | 批次前12天（yyyymmdd） | ${taskid?calDate(-12,'D')} |
| l12h_hour_id | 前12小时 | ${taskid?calDate(-12,'h','yyyyMMddHH')} |
| l13d_taskid | 批次前13天（yyyymmdd） | ${taskid?calDate(-13,'D')} |
| l14d_taskid | 批次前14天（yyyymmdd） | ${taskid?calDate(-14,'D')} |
| l15d_taskid | 批次前15天（yyyymmdd） | ${taskid?calDate(-15,'D')} |
| l16d_taskid | 批次前16天（yyyymmdd） | ${taskid?calDate(-16,'D')} |
| l17d_taskid | 批次前17天（yyyymmdd） | ${taskid?calDate(-17,'D')} |
| l18d_taskid | 批次前18天（yyyymmdd） | ${taskid?calDate(-18,'D')} |
| l19d_taskid | 批次前19天（yyyymmdd） | ${taskid?calDate(-19,'D')} |
| l20d_taskid | 批次前20天（yyyymmdd） | ${taskid?calDate(-20,'D')} |
| l21d_taskid | 批次前21天（yyyymmdd） | ${taskid?calDate(-21,'D')} |
| l22d_taskid | 批次前22天（yyyymmdd） | ${taskid?calDate(-22,'D')} |
| l23d_taskid | 批次前23天（yyyymmdd） | ${taskid?calDate(-23,'D')} |
| l24d_taskid | 批次前24天（yyyymmdd） | ${taskid?calDate(-24,'D')} |
| l25d_taskid | 批次前25天（yyyymmdd） | ${taskid?calDate(-25,'D')} |
| l26d_taskid | 批次前26天（yyyymmdd） | ${taskid?calDate(-26,'D')} |
| l27d_taskid | 批次前27天（yyyymmdd） | ${taskid?calDate(-27,'D')} |
| l28d_taskid | 批次前28天（yyyymmdd） | ${taskid?calDate(-28,'D')} |
| l29d_taskid | 批次前29天（yyyymmdd） | ${taskid?calDate(-29,'D')} |
| l30d_taskid | 批次前30天（yyyymmdd） | ${taskid?calDate(-30,'D')} |
| last2MonThisDay | 上月当天 | SELECT (to_date(substring('${taskid}',1,8), 'YYYYMMDD') - INTERVAL '2 months')::date |
| last2month_beginday | 前2月月初(YYYY-MM-DD) | SELECT DATE_TRUNC('MONTH', TO_DATE(REPLACE('${taskid?substring(0,8)}', '-', ''), 'YYYYMMDD') - INTERVAL '2 MONTHS')::DATE |
| last2month_endday | 前2月最后一天(YYYY-MM-DD) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last2monthendday | 前2月最后一天(YYYYMMDD) | SELECT REPLACE( TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last3MonThisDay | 上月当天 | SELECT (to_date(substring('${taskid}',1,8), 'YYYYMMDD') - INTERVAL '3 months')::date |
| last3month_beginday | 前3月月初(YYYY-MM-DD) | SELECT DATE_TRUNC('MONTH', TO_DATE(REPLACE('${taskid?substring(0,8)}', '-', ''), 'YYYYMMDD') - INTERVAL '3 MONTHS')::DATE |
| last3month_endday | 前3月最后一天(YYYY-MM-DD) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last3month_taskid | 数据日期前三月同期日(YYYY-MM-DD) | SELECT (to_date('${taskid?substring(0,8)}', 'YYYY-MM-DD') - interval '3 months')::date |
| last3monthendday | 前3月最后一天(YYYYMMDD) | SELECT REPLACE( TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last3yearcurday | 3年前同期(yyyyMMdd) | SELECT TO_CHAR( TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '3 year', 'YYYYMMDD' ) AS previous_year_today_date; |
| last4month_endday | 前4月最后一天(YYYY-MM-DD) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last4monthendday | 前4月最后一天(YYYYMMDD) | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last5month | 数据日期的前5月的年月(YYYYMM) | SELECT REPLACE( SUBSTRING( TO_CHAR( (DATE '${taskid?substring(0,8)}' - INTERVAL '5 months'), 'YYYY-MM-DD' ), 1, 7 ), '-', '' ) |
| last5month_endday | 前5月最后一天(YYYY_MM_DD) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last5monthendday | 前5月最后一天(YYYYMMDD) | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last6month_day | 数据日期的后6月同期(YYYY-MM-DD) | SELECT (to_date( concat( substr('${taskid}', 1, 4), -- 年份 '-', substr('${taskid}', 5, 2), -- 月份 '-', COALESCE(substr('${taskid}', 7, 2), '01') -- 日期，默认为1 ), 'YYYY-MM-DD' -- 日期格式 ) + INTERVAL '6 months')::DATE AS added_date; |
| last6month_endday | 前6月最后一天(YYYY_MM_DD) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last6month_taskid | 前6月同期(YYYY_MM_DD) | SELECT (to_date('${taskid?substring(0,8)}', 'YYYY-MM-DD') - interval '6 months')::date |
| last6monthday | 数据日期的后6月同期(YYYYMMDD) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') + interval '6 months', 'YYYYMMDD'); |
| last6monthendday | 前6月最后一天(YYYYMMDD) | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last7month_endday | 前7月最后一天(YYYY_MM_DD) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last7monthendday | 前7月最后一天(YYYYMMDD) | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last8month_endday | 前8月最后一天(YYYY_MM_DD) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last8monthendday | 前8月最后一天(YYYYMMDD) | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last9month_endday | 前9月最后一天(YYYY_MM_DD) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last9monthendday | 前9月最后一天(YYYYMMDD) | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last10month_endday | 前10月最后一天(YYYY_MM_DD) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last10monthendday | 前10月最后一天(YYYYMMDD) | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last11month_endday | 前11月最后一天(YYYY_MM_DD) | SELECT (to_date(substring('${taskid}' from 1 for 6) |
| last11monthendday | 前11月最后一天(YYYYMMDD) | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last12month_endday | 前12月最后一天(YYYY_MM_DD) | SELECT (to_date(substring('${taskid}' from 1 for 6) |
| last12monthendday | 前12月最后一天(YYYYMMDD) | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last15mi | 运行批次前15分钟(YYYYmmddhhMMss) | SELECT CASE WHEN LENGTH('${taskid}') = 6 THEN to_char(to_timestamp('${taskid}' |
| last15miday | 运行批次前15分钟所在日(YYYYmmdd) | SELECT SUBSTRING( TO_CHAR( CASE WHEN LENGTH('${taskid}') = 6 THEN (TO_TIMESTAMP(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| last15mihour | 运行批次前15分钟所在时(YYYYmmddhh) | SELECT CASE WHEN LENGTH('${taskid}') = 6 THEN to_char(to_timestamp('${taskid}' |
| last15mimonth | 运行批次前15分钟所在月(YYYYmm) | SELECT SUBSTRING(formatted_time, 1, 6) FROM ( SELECT CASE WHEN LENGTH('${taskid}') = 6 THEN TO_CHAR(TO_TIMESTAMP('${taskid}' |
| lastMonThisDay | 上月当天 | SELECT (to_date(substring('${taskid}',1,8), 'YYYYMMDD') - INTERVAL '1 months')::date |
| last_year_cur_day | 去年同期日期(yyyy-mm-dd) | SELECT (to_date(${taskid?substring(0,8)}, 'YYYYMMDD') - INTERVAL '1 year')::date |
| last_year_end_month_first_day | 上年年底12月01号(yyyy-mm-dd) | SELECT to_char(date_trunc('year', to_date(substring('${taskid}',1,8), 'YYYYMMDD') - INTERVAL '1 year'), 'YYYY') |
| last_year_last_month | 去年上月份(yyyyMM) | ${taskid?substring(0,6)?calDate(-13,'m','yyyyMM')} |
| last_year_last_one_month_first_day | 去年同期上月一号(yyyy-mm-dd) | SELECT TO_CHAR( TO_DATE(SUBSTRING('${taskid}', 1, 6) \|\| '01', 'YYYYMMDD')- INTERVAL '1 year' - INTERVAL '1 month', 'YYYY-MM-DD' ) AS first_day_of_month; |
| lastmonth_endday | 上月最后一天(YYYY-MM-DD) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| lastmonth_year | 上月对应的年(YYYY) | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| lastmonthendday | 上月最后一天(YYYYMMDD) | SELECT REPLACE( TO_CHAR( TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| lastyearcurday | 去年同期(yyyyMMdd) | SELECT TO_CHAR( (TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '1 year')::date, 'YYYYMMDD' ) AS calculated_date; |
| ld_taskid2 | 批次对应前一天（yyyymmdd）2 | ${taskid?calDate(-1,'D','yyyyMMdd')} |
| ld_taskid | 批次对应前一天（yyyymmdd） | ${taskid?calDate(-1,'D')} |
| ldtaskid | 当月最后一天(YYYYMMDD) | SELECT REPLACE(TO_CHAR((DATE_TRUNC('MONTH', TO_DATE(SUBSTRING('${taskid}', 1, 6) |
| lm_01taskid | 上月1号（yyyymm01） | ${taskid?calDate(-1,'M','yyyyMM')}01 |
| lm_days | 上月的天数 | ${taskid?calDate(-1,'M')?calDate(0,'L')?substring(6,8)} |
| lm_lastday | 上月最后一天(yyyy-mm-dd) | ${taskid?calDate(-1,'M','yyyyMMdd')?calDate(0,'L')?calDate(+0,'D','yyyy-MM-dd')} |
| lm_mm | 上月批次(mm) | ${taskid?calDate(-1,'M','MM')} |
| lm_mtaskid | 上月批次(yyyymm) | ${taskid?calDate(-1,'M','yyyyMM')} |
| lm_taskid | 批次对应上月同期日（yyyymmdd） | ${taskid?calDate(-1,'M')} |
| lmlastday | 上月最后一天（yyyymmdd） | ${taskid?calDate(-1,'M','yyyyMMdd')?calDate(0,'L')} |
| lmm | 上月（mm） | ${taskid?calDate(-1,'M')?substring(4,6)} |
| lq_lastdate | 数据日期上季度的最后月月末(YYYY-MM-DD) | SELECT to_char( DATE_TRUNC('quarter',TO_DATE('${taskid?substring(0,8)}'))- INTERVAL '1 day','yyyy-mm-dd' )AS last_day_of_prev_quarter; |
| lq_lastdate_y | 据日期上季度的最后月所在年(YYYY) | SELECT SUBSTRING(REPLACE(TO_CHAR(LAST_DAY(DATE_TRUNC('quarter', DATE '${taskid?substring(0,8)}'::DATE - INTERVAL '3 month')),'YYYY-MM-DD'),'-',''), 1, 4) AS result; |
| lq_lastdate_ym | 数据日期上季度的最后月年月(YYYYMM) | SELECT to_char( (to_date( CONCAT( substring('${taskid}' FROM 1 FOR 4), CASE WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 1 AND 3 THEN '03' WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 4 AND 6 THEN '06' WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 7 AND 9 THEN '09' WHEN CAST(substring('${taskid}' FROM 5 FOR 2) AS INTEGER) BETWEEN 10 AND 12 THEN '12' END ), 'YYYYMM' ) - INTERVAL '3 months'), 'YYYYMM' ) AS formatted_date; |
| lyThisMonLastday | 去年当月最后一天，格式：ymd | SELECT TO_CHAR(LAST_DAY((TO_DATE(SUBSTRING('${taskid}', 1, 6) |
| ly_This_Mon_Lastday | 去年当月最后一天，格式：y-m-d | SELECT TO_CHAR(LAST_DAY((TO_DATE(SUBSTRING('${taskid}', 1, 6) |
| ly_lasttaskid | 去年最后一天(yyyymmdd) | ${taskid?calDate(-1,'Y','yyyy')}1231 |
| ly_mtaskid | 去年同月（yyyymm） | ${taskid?calDate(-1,'Y','yyyyMM')} |
| ly_taskday | 去年同期(YYYY-MM-DD) | SELECT TO_CHAR((TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '1 year'), 'YYYY-MM-DD') AS formatted_date; |
| ly_taskid | 去年同期日（yyyymmdd) | ${taskid?calDate(-1,'Y')} |
| ly_taskmonth | 去年同期月份(YYYY-MM) | SELECT SUBSTRING(date_part('year', TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD') - INTERVAL '1 year') FROM 1 FOR 4) |
| ly_ytaskid | 去年（yyyy) | ${taskid?calDate(-1,'Y','yyyy')} |
| lyld_taskid | 去年同期前一天（yyyymmdd） | ${taskid?calDate(-1,'Y')?calDate(-1,'D')} |
| lylm_taskid | 去年最后一个月（yyyymm） | ${taskid?calDate(-1,'Y','yyyy')}12 |
| lytask_day | 去年同期(YYYY-MM-DD) | SELECT (to_timestamp(SUBSTRING('${taskid}' FROM 1 FOR 4) |
| lytaskday | 去年同期(YYYYMMDD) | SELECT to_char((to_date('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '1 year')::date, 'YYYYMMDD') AS new_date; |
| lytaskid | 去年同期年月(YYYYMM) | SELECT substring( replace( to_char( CAST(CONCAT(SUBSTRING('${'${taskid}'}01' FROM 1 FOR 4), '-', SUBSTRING('${'${taskid}'}01' FROM 5 FOR 2), '-', SUBSTRING('${'${taskid}'}01' FROM 7 FOR 2)) AS DATE) - INTERVAL '1 year', 'YYYY-MM-DD'), '-', '' ), 1, 6 ) AS extracted_date |
| m_taskday | 上月同期日(YYYY-MM-DD) | SELECT (to_date('${taskid?substring(0,8)}', 'YYYY-MM-DD') - interval '1 month')::date |
| maxdate | 最大日期 | 4000-12-31 |
| maxdatetime | 最大日期细到时分秒 | 4000-12-31 23:59:59 |
| mindate | 最小日期 | 1900-01-01 |
| mindatetime | 最小日期细到时分秒 | 1900-01-01 00:00:01 |
| minutId | 时间分钟(yyyymmddHHMM) | ${taskid?calDate(0,'m','yyyyMMddHHmm')} |
| minuteId | 时间-分钟(yyyymmddHHMM) | ${taskid?substring(0,12)} |
| mm | 月（mm） | ${taskid?calDate(0,'M')?substring(4,6)} |
| month | 当前日期的月 | SELECT SUBSTRING('${taskid}', 5, 2) |
| monthFiveDay | 当月第五天(yyyy-mm-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE)) + INTERVAL '4 day'), 'YYYY-MM-DD'); |
| monthFiveDayX | 当月第五天(yyyymmdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE)) + INTERVAL '4 day'), 'YYYYMMDD'); |
| month_id | 当前月份(y-m) | ${taskid?substring(0,6)?calDate(0,'m','yyyy-MM')} |
| monthday | 当前日期的月日 | SELECT SUBSTRING('${taskid}', 5, 4); |
| monthid | 当前月份(ym) | ${taskid?substring(0,6)} |
| mtask_id | 月批次 | ${taskid?substring(0,6)} |
| mtaskday | 上月同期(YYYYMMDD) | SELECT SUBSTRING( TO_CHAR( (TO_DATE( CONCAT( SUBSTRING('${'${taskid}'}01' FROM 1 FOR 4), '-', SUBSTRING('${'${taskid}'}01' FROM 5 FOR 2), '-', SUBSTRING('${'${taskid}'}01' FROM 7 FOR 2) ), 'YYYY-MM-DD' ) - INTERVAL '1 month'), 'YYYYMMDD' ), 1, 8 ) AS formatted_date |
| mtaskid | 月批次 | ${taskid?substring(0,6)} |
| n1_dayid_h | 后一个小时(yyyy-MM-dd HH) | SELECT SUBSTRING( CASE WHEN LENGTH(REPLACE('${taskid}', '-', '')) >= 10 THEN TO_CHAR( TO_TIMESTAMP(SUBSTRING(REPLACE('${taskid}', '-', '') |
| n1dayidh | 后一个小时(yyyyMMddHH) | SELECT SUBSTRING( CASE WHEN LENGTH(REPLACE('${taskid}', '-', '')) >= 10 THEN TO_CHAR( TO_TIMESTAMP(SUBSTRING(REPLACE('${taskid}', '-', '') |
| n1mtaskid | 数据日期的后1月 | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '-1 months' ), 'YYYYMM' ), 1, 6 ) |
| n2_dayid_h | 后二个小时(yyyy-MM-dd HH) | SELECT SUBSTRING( CASE WHEN LENGTH(REPLACE('${taskid}', '-', '')) >= 10 THEN TO_CHAR( TO_TIMESTAMP(SUBSTRING(REPLACE('${taskid}', '-', '') |
| n2_first_day | 下两个月一号(yyyy-mm-dd) | SELECT CASE WHEN LENGTH('${taskid}') = 6 THEN to_char(to_date('${taskid}' |
| n2d_taskid | 批次对应后2天（yyyymmdd） | ${taskid?calDate(+2)} |
| n2dayidh | 后二个小时(yyyyMMddHH) | SELECT SUBSTRING( CASE WHEN LENGTH(REPLACE('${taskid}', '-', '')) >= 10 THEN TO_CHAR( TO_TIMESTAMP(SUBSTRING(REPLACE('${taskid}', '-', '') |
| n2mtaskid | 数据日期的后2月 | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '-2 months' ), 'YYYYMM' ), 1, 6 ) |
| n3_first_day | 下三个月一号(yyyy-mm-dd) | SELECT CASE WHEN LENGTH('${taskid}') = 6 THEN TO_CHAR(TO_DATE('${taskid}' |
| n3d_taskid | 批次对应后3天（yyyymmdd） | ${taskid?calDate(+3)} |
| n3m_taskid | 3个月后批次（yyyymmdd） | ${taskid?calDate(+3,'M')} |
| n3mtaskid | 数据日期的后3月 | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '-3 months' ), 'YYYYMM' ), 1, 6 ) |
| n4mtaskid | 数据日期的后4月 | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '-4 months' ), 'YYYYMM' ), 1, 6 ) |
| n5mtaskid | 数据日期的后5月(YYYYMM) | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '-5 months' ), 'YYYYMM' ), 1, 6 ) |
| n6mtaskid | 数据日期的后6月 | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '-6 months' ), 'YYYYMM' ), 1, 6 ) |
| n7mtaskid | 数据日期的后7月(YYYYMM) | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '-7 months' ), 'YYYYMM' ), 1, 6 ) |
| n8mtaskid | 数据日期的后8月(YYYYMM) | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '-8 months' ), 'YYYYMM' ), 1, 6 ) |
| n9mtaskid | 数据日期的后9月(YYYYMM) | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '-9 months' ), 'YYYYMM' ), 1, 6 ) |
| n10mtaskid | 数据日期的后10月 | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '-10 months' ), 'YYYYMM' ), 1, 6 ) |
| n11mtaskid | 数据日期的后11月(YYYYMM) | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '-11 months' ), 'YYYYMM' ), 1, 6 ) |
| n_day_id | 后一天日期（y-m-d) | ${taskid?substring(0,8)?calDate(1,'d','yyyy-MM-dd')} |
| n_month_id | 下月月份(yyyy-mm) | ${taskid?substring(0,6)?calDate(1,'m','yyyy-MM')} |
| nd_taskid | 批次对应后一天（yyyymmdd） | ${taskid?calDate(+1,'D')} |
| ndayid | 后一天日期(ymd) | SELECT to_char(date_trunc('day', to_date(substring('${taskid}',1,8), 'YYYYMMDD') + interval '1 day'), 'YYYYMMDD') |
| next1d | 后1天日期(yyyymmdd) | SELECT to_char(date_trunc('day', to_date('${taskid?substring(0,8)}', 'YYYYMMDD') + interval '1 day'), 'YYYYMMDD'); |
| next2Month | 下两个月(yyyymm) | ${taskid?substring(0,6)?calDate(2,'m')} |
| nextMonth | 下月(yyyymm) | ${taskid?substring(0,6)?calDate(1,'m')} |
| nextm_first_day | 下月一号(yyyy-mm-dd) | SELECT TO_CHAR( (TO_DATE(CONCAT(SUBSTRING('${taskid}', 1, 4), '-', SUBSTRING('${taskid}', 5, 2), '-01'), 'YYYY-MM-DD') + INTERVAL '1 MONTH'), 'YYYY-MM-DD') AS var_val; |
| nextm_four_day | 下月四号（y-m-d） | ${taskid?calDate(1,'m','yyyy-MM-dd')?substring(0,7)}-04 |
| nextm_last_day | 下月最后一天(yyyy-mm-dd) | SELECT TO_CHAR(LAST_DAY(TO_DATE(SUBSTRING('${taskid}', 1, 6) |
| nextm_second_day | 下月二号（y-m-d） | ${taskid?calDate(1,'m','yyyy-MM-dd')?substring(0,7)}-02 |
| nextm_third_day | 下月三号（y-m-d） | ${taskid?calDate(1,'m','yyyy-MM-dd')?substring(0,7)}-03 |
| nextmfirstday | 下月一号(ymd) | ${taskid?substring(0,6)?calDate(1,'m')}01 |
| nextmlastday | 下月最后一天(yyyymmdd) | SELECT TO_CHAR(LAST_DAY((TO_DATE(SUBSTRING('${taskid}', 1, 6) |
| nextmonthlastday | 下个月最后一天 | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) + INTERVAL '1 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| nextmsecondday | 下月二号(ymd) | ${taskid?substring(0,6)?calDate(1,'m','yyyyMM')}02 |
| nextyear | 下一年(yyyy) | SELECT SUBSTRING(CURRENT_DATE + INTERVAL '1 year' FROM 1 FOR 4) |
| nm_01taskid | 下月一号（yyyymm01） | ${taskid?calDate(+1,'M','yyyyMM')}01 |
| nm_mm | 下月批次(mm) | ${taskid?calDate(+1,'M','MM')} |
| nm_mtaskid | 下月批次（yyyymm） | ${taskid?calDate(+1,'M','yyyyMM')} |
| nmonthid | 下月月份(yyyymm) | ${taskid?substring(0,6)?calDate(1,'m')} |
| nnntaskid | 数据日期后3月的年月(YYYYMM) | SELECT to_char( (to_date( concat( substr('${taskid}', 1, 4), '-', substr('${taskid}', 5, 2), '-', substr('${taskid}', 7, 2) ), 'YYYY-MM-DD' ) + INTERVAL '3 month'- INTERVAL '1 day'), 'YYYYMM' ) AS formatted_date |
| ntaskday | 数据日期的后1天(YYYYMMDD) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') + interval '1 day', 'YYYYMMDD'); |
| ny_ytaskid | 明年（yyyy） | ${taskid?calDate(+1,'Y','yyyy')} |
| op_date | 当前日期yyyy-MM-dd | ${taskid?substring(0,8)?calDate(0,'d','yyyy-MM-dd')} |
| op_month | 当月月份yyyy-MM-01 | ${taskid?substring(0,6)?calDate(0,'m','yyyy-MM')} |
| opdate | 当前日期yyyyMMdd | ${taskid?substring(0,8)} |
| opmonth | 当月月份yyyyMM | ${taskid?substring(0,6)} |
| p1_dayid_h | 前一个小时(yyyy-MM-dd HH) | SELECT SUBSTRING( CASE WHEN LENGTH(REPLACE('${taskid}', '-', '')) >= 10 THEN TO_CHAR( TO_TIMESTAMP(SUBSTRING(REPLACE('${taskid}', '-', '') |
| p1dayidh | 前一个小时(yyyyMMddHH) | SELECT SUBSTRING( CASE WHEN LENGTH(REPLACE('${taskid}', '-', '')) >= 10 THEN TO_CHAR( TO_TIMESTAMP(SUBSTRING(REPLACE('${taskid}', '-', '') |
| p1daymonthid | 前一天月份(yyyymm) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '1 day', 'YYYYMM'); |
| p1month | 上月同一天(yyyymmdd) | ${taskid?calDate(-1,'m')} |
| p1month_last_p31day | 上月最后一天的前31天(yyyymmdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '1 month') + INTERVAL '1 month' - INTERVAL '1 day'-INTERVAL '31 day'), 'YYYYMMDD'); |
| p1monthid | 上月同一天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '1 month', 'YYYY-MM-DD'); |
| p1year_p1dayid_30 | 今天的时间减去一年再减30天 | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '1 year'-interval '30 days', 'YYYY-MM-DD'); |
| p1year_p1dayid_31 | 今天的时间减去一年再减31天 | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '1 year'-interval '31 days', 'YYYY-MM-DD'); |
| p2_day_id | 前两天日期（y-m-d) | ${taskid?substring(0,8)?calDate(-2,'d','yyyy-MM-dd')} |
| p2_dayid_h | 前二个小时(yyyy-MM-dd HH) | SELECT SUBSTRING( CASE WHEN LENGTH(REPLACE('${taskid}', '-', '')) >= 10 THEN TO_CHAR( TO_TIMESTAMP(SUBSTRING(REPLACE('${taskid}', '-', '') |
| p2_dayid_last_day | 前2天日期_所在月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '2 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| p2_dayid_month | 前2天日期_所在月份(yyyy-MM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '2 days', 'YYYY-MM'); |
| p2_month_id | 前2个月(yyyy-mm) | SELECT to_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '2 month')), 'YYYY-MM'); |
| p2d_taskid | 数据日期的前2天(YYYY-MM-DD) | SELECT TO_CHAR((TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '2 days'), 'YYYY-MM-DD') AS formatted_date; |
| p2day_id | 当前日期减2天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '2 days', 'YYYY-MM-DD'); |
| p2dayid | 当前日期减2天(yyyymmdd) | SELECT TO_CHAR( (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 8), 'YYYYMMDD') - INTERVAL '2 DAY'), 'YYYYMMDD' ); |
| p2dayidh | 前二个小时(yyyyMMddHH) | SELECT SUBSTRING( CASE WHEN LENGTH(REPLACE('${taskid}', '-', '')) >= 10 THEN TO_CHAR( TO_TIMESTAMP(SUBSTRING(REPLACE('${taskid}', '-', '') |
| p2dayidlastday | 前2天日期_所在月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '2 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| p2dayidmonth | 前2天日期_所在月份(yyyyMM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '2 days', 'YYYYMM'); |
| p2dayidyear | 前2天所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '2 days', 'YYYY'); |
| p2dtaskid | 数据日期的前2天(YYYYMMDD) | SELECT REPLACE( TO_CHAR( (TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '2 days'), 'YYYY-MM-DD' ), '-', '' ) AS formatted_date |
| p2dyyyymm | 数据日期的前两天的年月(YYYYMM) | SELECT to_char(to_date('${taskid?substring(0,8)}', 'YYYY-MM-DD') - interval '2 day', 'YYYYMM') |
| p2m_taskid | 数据日期的前2月(YYYY-MM-DD) | SELECT ('${taskid?substring(0,8)}'::DATE - INTERVAL '2 months')::DATE |
| p2m_taskid_day | 数据日期的前2月(YYYYMMDD) | SELECT REPLACE( TO_CHAR( TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD') - INTERVAL '2 months', 'YYYYMMDD' ), '-', '' ) |
| p2monthdayid | 前2月同期日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '2 months', 'YYYYMMDD'); |
| p2monthid | 前2个月(ym) | ${taskid?substring(0,6)?calDate(-2,'m')} |
| p3_dayid_last_day | 前3天日期_所在月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '3 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| p3_dayid_month | 前3天日期_所在月份(yyyy-MM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '3 days', 'YYYY-MM'); |
| p3_month_first | 前三个月一号(yyyy-mm-dd) | SELECT CASE WHEN LENGTH(${'${taskid}'}) = 6 THEN TO_CHAR(DATE_TRUNC('MONTH', TO_DATE(${'${taskid}'} |
| p3_month_id | 前3个月(yyyy-mm) | SELECT to_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '3 month')), 'YYYY-MM'); |
| p3day_id | 当前日期减3天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '3 days', 'YYYY-MM-DD'); |
| p3dayid | 当前日期减3天（yyyymmdd) | SELECT to_char(to_date(SUBSTRING('${taskid}' FROM 1 FOR 8), 'YYYYMMDD') - INTERVAL '3 days', 'YYYYMMDD') |
| p3dayidlastday | 前3天日期_所在月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '3 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| p3dayidmonth | 前3天日期_所在月份(yyyyMM)月最后一天 | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '3 days', 'YYYYMM'); |
| p3dayidyear | 前3天所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '4 days', 'YYYY'); |
| p3dtaskid | 数据日期的前3天(YYYYMMDD) | SELECT substr( to_char( (to_date( concat( substr('${taskid}', 1, 4), -- 年份 '-', substr('${taskid}', 5, 2), -- 月份 '-', substr('${taskid}', 7, 2) -- 日期 ), 'YYYY-MM-DD' -- 日期格式 ) - INTERVAL '3 days'), -- 减去3天 'YYYYMMDD' -- 输出格式为'YYYYMMDD' ), 1, 8 -- 获取前8个字符 ) AS formatted_date |
| p3mLastDay | 前三个月最后一天(yyyy-mm-dd) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| p3mLastDayNew | 前三个月最后一天(yyyymmdd) | SELECT CASE WHEN LENGTH('${taskid}') = 8 THEN TO_CHAR( last_day(CONCAT(substring('${taskid}',1,6),'01')- INTERVAL '3 MONTHS'), 'YYYYMMDD') WHEN LENGTH('${taskid}') = 6 THEN TO_CHAR(last_day(CONCAT(substring('${taskid}',1,6), '01') - INTERVAL '3 MONTHS'), 'YYYYMMDD') END; |
| p3m_Last_Day | 前三个月最后一天(yyyy-mm-dd) | SELECT (TO_DATE(SUBSTRING('${taskid}' FROM 1 FOR 6) |
| p3monthdayid | 前3月同期日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '3 months', 'YYYYMMDD'); |
| p3monthid | 前3个月(ym) | ${taskid?substring(0,6)?calDate(-3,'m')} |
| p3monthlastday | 前3个月最后一天(yyyymmdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '3 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| p4_dayid_last_day | 前4天日期_所在月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '4 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| p4_dayid_month | 前4天日期_所在月份(yyyy-MM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '4 days', 'YYYY-MM'); |
| p4_month_first | 前四个月一号(yyyy-mm-dd) | SELECT CASE WHEN LENGTH(${'${taskid}'}) = 6 THEN TO_CHAR(DATE_TRUNC('MONTH', TO_DATE(${'${taskid}'} |
| p4_month_id | 前4个月(yyyy-mm) | SELECT to_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '4 month')), 'YYYY-MM'); |
| p4d_taskid | 数据日期的前4天(YYYY-MM-DD) | SELECT to_char( (to_date( concat( substr('${taskid}', 1, 4), '-', substr('${taskid}', 5, 2), '-', substr('${taskid}', 7, 2) ), 'YYYY-MM-DD' ) - INTERVAL '4 day'), 'YYYY-MM-DD' ) AS formatted_date |
| p4day_id | 当前日期减4天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '4 days', 'YYYY-MM-DD'); |
| p4dayid | 当前日期减4天(yyyymmdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '4 days', 'YYYYMMDD'); |
| p4dayidlastday | 前4天日期_所在月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '4 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| p4dayidmonth | 前4天日期_所在月份(yyyyMM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '4 days', 'YYYYMM'); |
| p4dayidyear | 前4天所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '4 days', 'YYYY'); |
| p4dtaskid | 数据日期的前4天(YYYYMMDD) | SELECT to_char( (to_date( concat( substr('${taskid}', 1, 4), '-', substr('${taskid}', 5, 2), '-', substr('${taskid}', 7, 2) ), 'YYYY-MM-DD' ) - INTERVAL '4 day'), 'YYYYMMDD' ) AS formatted_date |
| p4monthdayid | 前4月同期日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '4 months', 'YYYYMMDD'); |
| p4monthid | 前4个月(ym) | ${taskid?substring(0,6)?calDate(-4,'m')} |
| p5_dayid_last_day | 前5天日期_所在月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '5 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| p5_dayid_month | 前5天日期_所在月份(yyyy-MM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '5 days', 'YYYY-MM'); |
| p5_month_first | 前五个月一号(yyyy-mm-dd) | SELECT CASE WHEN LENGTH(${'${taskid}'}) = 6 THEN TO_CHAR(DATE_TRUNC('MONTH', TO_DATE(${'${taskid}'} |
| p5_month_id | 前5个月(yyyy-mm) | SELECT to_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '5 month')), 'YYYY-MM'); |
| p5d_taskid | 数据日期的前5天(YYYY-MM-DD) | SELECT to_char( (to_date( concat( substr('${taskid}', 1, 4), '-', substr('${taskid}', 5, 2), '-', substr('${taskid}', 7, 2) ), 'YYYY-MM-DD' ) - INTERVAL '5 day'), 'YYYY-MM-DD' ) AS formatted_date |
| p5day_id | 当前日期减5天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '5 days', 'YYYY-MM-DD'); |
| p5dayid | 当前日期减5天(yyyymmdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '5 days', 'YYYYMMDD'); |
| p5dayidlastday | 前5天日期_所在月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '5 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| p5dayidmonth | 前5天日期_所在月份(yyyyMM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '5 days', 'YYYYMM'); |
| p5dayidyear | 前5天所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '5 days', 'YYYY'); |
| p5dtaskid | 数据日期的前5天(YYYYMMDD) | SELECT to_char( (to_date( concat( substr('${taskid}', 1, 4), '-', substr('${taskid}', 5, 2), '-', substr('${taskid}', 7, 2) ), 'YYYY-MM-DD' ) - INTERVAL '5 day'), 'YYYYMMDD' ) AS formatted_date |
| p5monthdayid | 前5月同期日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '5 months', 'YYYYMMDD'); |
| p5monthid | 前5个月(ym) | ${taskid?substring(0,6)?calDate(-5,'m')} |
| p6_dayid_last_day | 前6天日期_所在月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '6 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| p6_dayid_month | 前6天日期_所在月份(yyyy-MM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '6 days', 'YYYY-MM'); |
| p6_month_first | 前六个月一号(yyyy-mm-dd) | SELECT CASE WHEN LENGTH(${'${taskid}'}) = 6 THEN TO_CHAR(DATE_TRUNC('MONTH', TO_DATE(${'${taskid}'} |
| p6_month_id | 前6个月(yyyy-mm) | SELECT to_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '6 month')), 'YYYY-MM'); |
| p6d_taskid | 数据日期的前6天(YYYY-MM-DD) | SELECT to_char( (to_date( concat( substr('${taskid}', 1, 4), '-', substr('${taskid}', 5, 2), '-', substr('${taskid}', 7, 2) ), 'YYYY-MM-DD' ) - INTERVAL '6 day'), 'YYYY-MM-DD' ) AS formatted_date |
| p6day_id | 当前日期减6天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '6 days', 'YYYY-MM-DD'); |
| p6dayid | 前6天日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '6 days', 'YYYYMMDD'); |
| p6dayidlastday | 前6天日期_所在月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '6 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| p6dayidmonth | 前6天日期_所在月份(yyyyMM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '6 days', 'YYYYMM'); |
| p6dayidyear | 前6天所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '6 days', 'YYYY'); |
| p6dtaskid | 数据日期的前6天(YYYYMMDD) | SELECT to_char( (to_date( concat( substr('${taskid}', 1, 4), '-', substr('${taskid}', 5, 2), '-', substr('${taskid}', 7, 2) ), 'YYYY-MM-DD' ) - INTERVAL '6 day'), 'YYYYMMDD' ) AS formatted_date |
| p6month_day | 数据日期前6月(yyyymmdd) | SELECT REPLACE( TO_CHAR( (TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD') - INTERVAL '6 months'), 'YYYY-MM-DD' ), '-', '' ) |
| p6monthdayid | 前6月同期日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '6 months', 'YYYYMMDD'); |
| p6monthid | 前6个月(ym) | ${taskid?substring(0,6)?calDate(-6,'m')} |
| p6mtaskid | 数据日期的前6月(YYYYMM) | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '6 months' ), 'YYYYMM' ), 1, 6 ) |
| p7_dayid_last_day | 前7天日期_所在月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '7 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| p7_dayid_month | 前7天日期_所在月份(yyyy-MM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '7 days', 'YYYY-MM'); |
| p7_month_first | 前七个月一号(yyyy-mm-dd) | SELECT CASE WHEN LENGTH(${'${taskid}'}) = 6 THEN TO_CHAR(DATE_TRUNC('MONTH', TO_DATE(${'${taskid}'} |
| p7_month_id | 前7个月(yyyy-mm) | SELECT to_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '7 month')), 'YYYY-MM'); |
| p7day_id | 当前日期减7天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '7 days', 'YYYY-MM-DD'); |
| p7dayid | 前7天日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '7 days', 'YYYYMMDD'); |
| p7dayidlastday | 前7天日期_所在月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '7 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| p7dayidmonth | 前7天日期_所在月份(yyyyMM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '7 days', 'YYYYMM'); |
| p7dayidyear | 前7天所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '7 days', 'YYYY'); |
| p7dtaskid | 数据日期的前7天(YYYYMMDD) | SELECT TO_CHAR((TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '7 days'), 'YYYYMMDD') AS formatted_date; |
| p7monthdayid | 前7月同期日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '7 months', 'YYYYMMDD'); |
| p7monthid | 前7个月(ym) | ${taskid?substring(0,6)?calDate(-7,'m')} |
| p7mtaskid | 数据日期的前7月YYYYMM | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '7 months' ), 'YYYYMM' ), 1, 6 ) |
| p8_dayid_last_day | 前8天日期_所在月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '8 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| p8_dayid_month | 前8天日期_所在月份(yyyy-MM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '8 days', 'YYYY-MM'); |
| p8_month_first | 前八个月一号(yyyy-mm-dd) | SELECT CASE WHEN LENGTH(${'${taskid}'}) = 6 THEN TO_CHAR(DATE_TRUNC('MONTH', TO_DATE(${'${taskid}'} |
| p8_month_id | 前8个月(yyyy-mm) | SELECT to_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '8 month')), 'YYYY-MM'); |
| p8dayid | 前8天日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '8 days', 'YYYYMMDD'); |
| p8dayidlastday | 前8天日期_所在月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '8 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| p8dayidmonth | 前8天日期_所在月份(yyyyMM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '8 days', 'YYYYMM'); |
| p8dayidyear | 前8天所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '8 days', 'YYYY'); |
| p8dtaskid | 数据日期的前8天(YYYYMMDD) | SELECT to_char( (to_date( concat( substr('${taskid}', 1, 4), '-', substr('${taskid}', 5, 2), '-', substr('${taskid}', 7, 2) ), 'YYYY-MM-DD' ) - INTERVAL '8 day'), 'YYYYMMDD' ) AS formatted_date |
| p8monthdayid | 前8月同期日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '8 months', 'YYYYMMDD'); |
| p8monthid | 前8个月(ym) | ${taskid?substring(0,6)?calDate(-8,'m')} |
| p8mtaskid | 数据日期的前8月(YYYYMM) | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '8 months' ), 'YYYYMM' ), 1, 6 ) |
| p9_month_first | 前九个月一号(yyyy-mm-dd) | SELECT CASE WHEN LENGTH(${'${taskid}'}) = 6 THEN TO_CHAR(DATE_TRUNC('MONTH', TO_DATE(${'${taskid}'} |
| p9_month_id | 前9个月(yyyy-mm) | SELECT to_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '9 month')), 'YYYY-MM'); |
| p9monthdayid | 前9月同期日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '9 months', 'YYYYMMDD'); |
| p9monthid | 前9个月(ym) | ${taskid?substring(0,6)?calDate(-9,'m')} |
| p9mtaskid | 数据日期的前9月(YYYYMM) | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '9 months' ), 'YYYYMM' ), 1, 6 ) |
| p10_month_first | 前十个月一号(yyyy-mm-dd) | SELECT CASE WHEN LENGTH(${'${taskid}'}) = 6 THEN TO_CHAR(DATE_TRUNC('MONTH', TO_DATE(${'${taskid}'} |
| p10_month_id | 前10个月(yyyy-mm) | SELECTto_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '10 month')), 'YYYY-MM'); |
| p10monthdayid | 前10月同期日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '10 months', 'YYYYMMDD'); |
| p10monthid | 前10个月(ym) | ${taskid?substring(0,6)?calDate(-10,'m')} |
| p10mtaskid | 数据日期的前10月(YYYYMM) | SELECT SUBSTRING( TO_CHAR( ( TO_DATE( CONCAT( SUBSTRING('${taskid}01' FROM 1 FOR 4), '-', LPAD(SUBSTRING('${taskid}01' FROM 5 FOR 2), 2, '0'), '-', '01' ), 'YYYY-MM-DD' ) - INTERVAL '10 months' ), 'YYYYMM' ), 1, 6 ) |
| p11_month_first | 前十一个月一号(yyyy-mm-dd) | SELECT CASE WHEN LENGTH(${'${taskid}'}) = 6 THEN TO_CHAR(DATE_TRUNC('MONTH', TO_DATE(${'${taskid}'} |
| p11_month_id | 前11个月(yyyy-mm) | SELECTto_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '11 month')), 'YYYY-MM'); |
| p11monthdayid | 前11月同期日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '11 months', 'YYYYMMDD'); |
| p11monthid | 前11个月(ym) | ${taskid?substring(0,6)?calDate(-11,'m')} |
| p11mtaskid | 数据日期的前11月(YYYYMM) | SELECT TO_CHAR( CONCAT( substring('${taskid}',1,6),'01' )::date - INTERVAL '11 months' , 'YYYYMM' ) |
| p12_month_first | 前十二个月一号(yyyy-mm-dd) | SELECT CASE WHEN LENGTH(${'${taskid}'}) = 6 THEN TO_CHAR(DATE_TRUNC('MONTH', TO_DATE(${'${taskid}'} |
| p12_month_id | 前12个月(yyyy-mm) | SELECTto_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '12 month')), 'YYYY-MM'); |
| p12monthdayid | 前12月同期日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '12 months', 'YYYYMMDD'); |
| p12monthid | 前12个月(ym) | ${taskid?substring(0,6)?calDate(-12,'m')} |
| p13_month_id | 前13个月(yyyy-mm) | SELECT to_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '13 month')), 'YYYY-MM'); |
| p13day_id | 当前日期减13天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '13 days', 'YYYY-MM-DD'); |
| p13monthid | 前13个月(yyyymm) | SELECT to_char(date_trunc('month', ('${taskid?substring(0,8)}'::date - interval '13 month')), 'YYYYMM') |
| p14_month_id | 前14个月(yyyy-mm) | SELECT to_char(date_trunc('month', (date '${taskid?substring(0,8)}' - interval '14 month')), 'YYYY-MM'); |
| p14monthid | 前14个月(yyyymm) | SELECT to_char(date_trunc('month', ('${taskid?substring(0,8)}'::date - interval '14 month')), 'YYYYMM') |
| p30_dayid_last_day | 前30天日期_所在月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '30 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| p30_dayid_month | 前30天日期_所在月份(yyyy-MM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '30 days', 'YYYY-MM'); |
| p30d_taskid | 数据日期前30天(yyyymmdd) | SELECT REPLACE( TO_CHAR( (TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD') - INTERVAL '30 days'), 'YYYY-MM-DD' ), '-', '' ) |
| p30dayid | 前30天日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '30 days', 'YYYYMMDD'); |
| p30dayidlastday | 前30天日期_所在月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '30 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| p30dayidmonth | 前30天日期_所在月份(yyyyMM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '30 days', 'YYYYMM'); |
| p30dayidyear | 前30天所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '30 days', 'YYYY'); |
| p31day | 前31天(yyyymmdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '31 days', 'YYYYMMDD'); |
| p31dayid | 前31天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '31 days', 'YYYY-MM-DD'); |
| p32day | 前32天(yyyymmdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '32 days', 'YYYYMMDD'); |
| p32dayid | 前32天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '32 days', 'YYYY-MM-DD'); |
| p60_dayid_last_day | 前60天日期_所在月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '60 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| p60_dayid_month | 前60天日期_所在月份(yyyy-MM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '60 days', 'YYYY-MM'); |
| p60dayid | 前60天日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '60 days', 'YYYYMMDD'); |
| p60dayidlastday | 前60天日期_所在月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '60 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| p60dayidmonth | 前60天日期_所在月份(yyyyMM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '60 days', 'YYYYMM'); |
| p60dayidyear | 前60天所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '60 days', 'YYYY'); |
| p90_dayid_last_day | 前90天日期_所在月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '90 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| p90_dayid_month | 前90天日期_所在月份(yyyy-MM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '90 days', 'YYYY-MM'); |
| p90dayid | 前90天日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '90 days', 'YYYYMMDD'); |
| p90dayidlastday | 前90天日期_所在月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '90 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| p90dayidmonth | 前90天日期_所在月份(yyyyMM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '90 days', 'YYYYMM'); |
| p90dayidyear | 前90天所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '90 days', 'YYYY'); |
| p91dayid | 前91天日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '91 days', 'YYYYMMDD'); |
| p145dayid | 前145天日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '145 days', 'YYYYMMDD'); |
| p_day_id | 前一天日期（y-m-d） | ${taskid?substring(0,8)?calDate(-1,'d','yyyy-MM-dd')} |
| p_dayid_last_day | 前1天日期_所在月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '1 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| p_dayid_month | 前1天日期_所在月份(yyyy-MM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '1 day', 'YYYY-MM'); |
| p_month_id | 上月月份(y-m) | ${taskid?substring(0,6)?calDate(-1,'m','yyyy-MM')} |
| p_taskid | 数据日期的上月(YYYY_MM) | SELECT to_char(to_date('${taskid?substring(0,8)}', 'YYYY-MM-DD') - interval '1 month', 'YYYY-MM') |
| pd_taskid | 数据日期的前一天(YYYY-MM-DD) | SELECT TO_CHAR((TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '1 days'), 'YYYY-MM-DD') AS formatted_date; |
| pdayid | 前一天日期(ymd) | ${taskid?substring(0,8)?calDate(-1,'d')} |
| pdayidlastday | 前1天日期_所在月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '1 day') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pdayidmonth | 前1天日期_所在月份(yyyyMM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '1 day', 'YYYYMM'); |
| pdayidyear | 前1天所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '1 day', 'YYYY'); |
| pdtaskid | 数据日期的前一天(YYYYMMDD) | SELECT to_char( (to_date( concat( substr('${taskid}', 1, 4), '-', substr('${taskid}', 5, 2), '-', substr('${taskid}', 7, 2) ), 'YYYY-MM-DD' ) - INTERVAL '1 day'), 'YYYYMMDD' ) AS formatted_date |
| pdyyyy | 数据日期前一天的年(YYYY) | SELECT to_char(to_date('${taskid?substring(0,8)}', 'YYYY-MM-DD') - interval '1 day', 'YYYY') |
| pdyyyymm | 数据日期的前一天的年月(YYYYMM) | SELECT to_char(to_date('${taskid?substring(0,8)}', 'YYYY-MM-DD') - interval '1 day', 'YYYYMM') |
| permrateday | 环比时间(前一月) | ${taskid?calDate(-1,'m')} |
| ply_taskday | 数据日期前一天去年同期(YYYY-MM-DD) | SELECT (to_date('${taskid?substring(0,8)}', 'YYYY-MM-DD') - interval '1 day' - interval '1 year')::date |
| plytaskid | 数据日期前一天去年同期年月(YYYYMM) | SELECT SUBSTRING( TO_CHAR( (DATE '${taskid?substring(0,8)}' - INTERVAL '1 day' - INTERVAL '1 year'), 'YYYYMM' ), 1, 6 ) |
| pmm | 数据日期的上月(MM) | SELECT to_char(to_date(substring('${taskid}01', 1, 8), 'YYYYMMDD') - interval '1 month', 'MM'); |
| pmonthdayid | 前1月同期日期(yyyyMMdd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '1 months', 'YYYYMMDD'); |
| pmonthid | 上月月份(ym) | ${taskid?substring(0,6)?calDate(-1,'m')} |
| pppptaskid | 数据日期的上4月(YYYYMM) | SELECT substring(replace(CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '4 months', '-', ''), 1, 6) AS extracted_date; |
| ppptaskid | 数据日期的上3月(YYYYMM) | SELECT substring(replace(CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '3 months', '-', ''), 1, 6) AS extracted_date; |
| pptaskid | 数据日期的上2月(YYYYMM) | SELECT to_char( (to_date( concat( substr('${taskid}', 1, 4), '-', substr('${taskid}', 5, 2), '-', substr('${taskid}', 7, 2) ), 'YYYY-MM-DD' ) - INTERVAL '2 month'- INTERVAL '1 day'), 'YYYYMM' ) AS formatted_date |
| pre2monthlastday | 前两个月最后一天(yyyymmdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '2 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pre3monthlastday | 前3月月末日期(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '3 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pre4monthlastday | 前4月月末日期(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '4 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pre5monthlastday | 前5月月末日期(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '5 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pre6m_last_day | 前六个月最后一天 | SELECT TO_CHAR(last_day(DATE_TRUNC('month', TIMESTAMP '${taskid?substring(0,8)}'::DATE - INTERVAL '6 months')), 'YYYY-MM-DD'); |
| pre6monthlastday | 前6月月末日期(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '6 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pre7monthlastday | 前7月月末日期(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '7 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pre8d | 前8天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '8 days', 'YYYY-MM-DD'); |
| pre8monthlastday | 前8月月末日期(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '8 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pre9d | 前9天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '9 days', 'YYYY-MM-DD'); |
| pre9monthlastday | 前9月月末日期(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '9 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pre10d | 前10天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '10 days', 'YYYY-MM-DD'); |
| pre10monthlastday | 前10月月末日期(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '10 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pre11d | 前11天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '11 days', 'YYYY-MM-DD'); |
| pre11monthlastday | 前11月月末日期(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '11 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pre12d | 前12天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '12 days', 'YYYY-MM-DD'); |
| pre12monthlastday | 前12月月末日期(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '12 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pre13d | 前13天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '13 days', 'YYYY-MM-DD'); |
| pre14d | 前14天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '14 days', 'YYYY-MM-DD'); |
| pre15d | 前15天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '15 days', 'YYYY-MM-DD'); |
| pre16d | 前16天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '16 days', 'YYYY-MM-DD'); |
| pre17d | 前17天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '17 days', 'YYYY-MM-DD'); |
| pre18d | 前18天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '18 days', 'YYYY-MM-DD'); |
| pre19d | 前19天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '19 days', 'YYYY-MM-DD'); |
| pre20d | 前20天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '20 days', 'YYYY-MM-DD'); |
| pre21d | 前21天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '21 days', 'YYYY-MM-DD'); |
| pre22d | 前22天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '22 days', 'YYYY-MM-DD'); |
| pre23d | 前23天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '23 days', 'YYYY-MM-DD'); |
| pre24d | 前24天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '24 days', 'YYYY-MM-DD'); |
| pre25d | 前25天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '25 days', 'YYYY-MM-DD'); |
| pre26d | 前26天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '26 days', 'YYYY-MM-DD'); |
| pre27d | 前27天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '27 days', 'YYYY-MM-DD'); |
| pre28d | 前28天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '28 days', 'YYYY-MM-DD'); |
| pre29d | 前29天日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '29 days', 'YYYY-MM-DD'); |
| pre30d | 前30天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '30 days', 'YYYY-MM-DD'); |
| pre60d | 前60天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '60 days', 'YYYY-MM-DD'); |
| pre62d | 前62天（yyyy-mm-dd） | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '62 days', 'YYYY-MM-DD'); |
| pre90d | 前90天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '90 days', 'YYYY-MM-DD'); |
| pre91d | 前91天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '91 days', 'YYYY-MM-DD'); |
| pre145d | 前145天(yyyy-mm-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '145 days', 'YYYY-MM-DD'); |
| preYearcurMonth | 去年当月(yyyymm) | SELECT TO_CHAR(TO_DATE( CONCAT(SUBSTRING('${taskid}', 1, 4), '-', SUBSTRING('${taskid}', 5, 2), '-', SUBSTRING('${taskid}', 7, 2)), 'YYYY-MM-DD') + INTERVAL '-1 year', 'YYYYMM') AS var_val; |
| preYearcurMonths | 去年当月(yyyymm),入参为年月日 | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '1 year', 'YYYYMM'); |
| pre_2month_last_day2 | 前两个月最后一天(yyyy-mm-dd),用于月调度 | ${taskid?calDate(-2,'m','yyyyMMdd')?calDate(0,'l','yyyy-MM-dd')} |
| pre_2month_last_day | 前两个月最后一天(yyyy-mm-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '2 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| pre_3month_last_day | 前3月月末日期(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '3 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| pre_4month_last_day | 前4月月末日期(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '4 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| pre_5month_last_day | 前5月月末日期(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '5 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| pre_6month_last_day | 前6月月末日期(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '6 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| pre_7month_last_day | 前7月月末日期(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '7 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| pre_8month_last_day | 前8月月末日期(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '8 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| pre_9month_last_day | 前9月月末日期(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '9 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| pre_10month_last_day | 前10月月末日期(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '10 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| pre_11month_last_day | 前11月月末日期(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '11 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| pre_12month_last_day | 前12月月末日期(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '12 month') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| pre_year_cur_months | 去年同期所在月份(yyyy-MM) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '1 year', 'YYYY-MM'); |
| preday | 前一天 | ${taskid?calDate(-1)} |
| predrateday | 同比时间(前一年) | ${taskid?calDate(-1,'y')} |
| prem_first_day | 上月第一天(y-m-d) | SELECT to_char( date_trunc('month', to_date(SUBSTRING('${taskid}' FROM 1 FOR 6), 'YYYYMM')) - INTERVAL '1 MONTH', 'YYYY-MM-01' ) AS calculated_date |
| prem_last_day | 上月最后一天(y-m-d) | SELECT (to_date(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '1 DAY')::DATE AS calculated_date; |
| prem_last_day_M | 月周期最后一天 | SELECT (date_trunc('MONTH', to_date(CONCAT(SUBSTRING('${taskid}', 1, 6), '01'), 'YYYYMMDD')) - INTERVAL '1 day')::date AS next_month_last_day; |
| premdays | 上月天数 | SELECT CASE WHEN LENGTH(${'${taskid}'}) = 6 THEN EXTRACT(DAY FROM LAST_DAY(TO_DATE(CONCAT(${'${taskid}'}, '01'), 'YYYYMM') - INTERVAL '1 MONTH')) WHEN LENGTH(${'${taskid}'}) = 8 THEN EXTRACT(DAY FROM LAST_DAY(TO_DATE(${'${taskid}'}, 'YYYYMMDD') - INTERVAL '1 MONTH')) END AS calculated_day; |
| premfirstday | 上月第一天(ymd) | ${taskid?substring(0,6)?calDate(-1,'m')}01 |
| premlastday | 上月最后一天(ymd) | SELECT CASE WHEN LENGTH('${taskid}') = 6 THEN TO_CHAR(LAST_DAY(TO_DATE('${taskid}' |
| premonthday | 上个月的今天yyyymmdd | SELECT REPLACE( TO_CHAR( (TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD') + INTERVAL '1 day')::DATE + INTERVAL '-1 month', 'YYYY-MM-DD' ), '-', '' ) |
| prey_last_day | 上年的最后一天 | ${taskid?substring(0,4)?calDate(-1,'y')}_12_31 |
| prey_last_month | 上一年最后一个月(yyyy-mm) | SELECT to_char(to_date(SUBSTRING('${taskid}' FROM 1 FOR 4) |
| preyearday | 去年的今天yyyymmdd | SELECT REPLACE( TO_CHAR( (TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD') + INTERVAL '1 day')::DATE + INTERVAL '-1 year', 'YYYY-MM-DD' ), '-', '' ) |
| preylastday | 上年最后一天(yyyymmdd) | ${taskid?substring(0,4)?calDate(-1,'y')}1231 |
| preylastmonth | 上一年最后一个月(yyyymm) | ${taskid?substring(0,4)?calDate(-1,'y')}12 |
| procRedisLogId | procRedisLogId | ${proclogid} |
| ptaskid | 数据日期的上月(YYYYMM) | SELECT to_char( (to_date( concat( substr('${taskid}', 1, 4), '-', substr('${taskid}', 5, 2), '-', substr('${taskid}', 7, 2) ), 'YYYY-MM-DD' ) - INTERVAL '1 month'- INTERVAL '1 day'), 'YYYYMM' ) AS formatted_date |
| pyear | 去年同期所在年份(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '1 year', 'YYYY'); |
| pyear_month_last_dayid | 去年同期所在月份月末(yyyy-MM-dd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '1 year') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYY-MM-DD'); |
| pyearid | 上一年(yyyy) | ${taskid?substring(0,4)?calDate(-1,'y')} |
| pyearmonthlastdayid | 去年同期所在月份月末(yyyyMMdd) | SELECT TO_CHAR((DATE_TRUNC('month', CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '1 year') + INTERVAL '1 month' - INTERVAL '1 day'), 'YYYYMMDD'); |
| pyyyy | 数据日期的上年(YYYY) | SELECT SUBSTRING( TO_CHAR( DATE_TRUNC('month', TO_DATE( CONCAT( SUBSTRING('${'${taskid}'}01' FROM 1 FOR 4), '-', SUBSTRING('${'${taskid}'}01' FROM 5 FOR 2), '-', '01' ), 'YYYY-MM-DD' )) - INTERVAL '12 months', 'YYYY' ), 1, 4 ) AS extracted_year |
| q_lastdate | 数据日期本季度的最后月月末(YYYY-MM-DD) | SELECT to_char( DATE_TRUNC('quarter',TO_DATE('${taskid?substring(0,8)}')) + INTERVAL '3 month' - INTERVAL '1 day','yyyy-mm-dd' )AS last_day_of_prev_quarter; |
| q_taskid | 数据日期季度首月的1号（YY-MM-DD) | SELECT TO_CHAR(DATE_TRUNC('quarter', TIMESTAMP '${taskid?substring(0,8)}')::DATE, 'YYYY-MM-01'); |
| q_taskidyyyymm | 数据日期季度首月的年月(YYYYMM) | SELECT to_char( DATE_TRUNC('quarter',TO_DATE('${taskid?substring(0,8)}')),'yyyymm' )AS last_day_of_prev_quarter; |
| quarter_num | 数据日期所在季度数 | SELECT SUBSTRING(CAST((EXTRACT(MONTH FROM TIMESTAMP '${taskid?substring(0,8)}') - 1) / 3 + 1 AS TEXT) FROM 1 FOR 1); |
| taskdate | 数据日期(YYYY-MM-DD) | SELECT SUBSTRING('${'${taskid}'}01' FROM 1 FOR 4) |
| taskidPre1m | 当前日期减1月 | SELECT (TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '1 month')::DATE |
| taskidPre2m | 当前日期减2月 | SELECT (TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '2 months')::DATE |
| taskidPre3m | 当前日期减3月 | SELECT (TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '3 months')::DATE |
| taskidPre4m | 当前日期减4月 | SELECT (TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '4 months')::DATE |
| taskidPre5m | 当前日期减5月 | SELECT (TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '5 months')::DATE |
| taskidPre6m | 当前日期减6月 | SELECT (TO_DATE('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '6 months')::DATE |
| taskidPre7m | 前7月同期日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '7 months', 'YYYY-MM-DD'); |
| taskidPre8m | 前8月同期日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '8 months', 'YYYY-MM-DD'); |
| taskidPre9m | 前9月同期日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '9 months', 'YYYY-MM-DD'); |
| taskidPre10m | 前10月同期日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '10 months', 'YYYY-MM-DD'); |
| taskidPre11m | 前11月同期日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '11 months', 'YYYY-MM-DD'); |
| taskidPre12m | 前12月同期日期(yyyy-MM-dd) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '12 months', 'YYYY-MM-DD'); |
| taskid_endday | 数据日期的最后一天(YYYY-MM-DD) | SELECT (date_trunc('MONTH', to_date(CONCAT(SUBSTRING('${taskid}', 1, 6), '01'), 'YYYYMMDD')) + INTERVAL '1 month' - INTERVAL '1 day')::date AS next_month_last_day; |
| taskid_yyyymm | 数据日期的年月(YYYY-MM) | SELECT to_char(CAST('${taskid?substring(0,8)}' AS DATE), 'YYYY-MM') AS extracted_date; |
| taskidp2d | 当前日期减2天(yyyy-mm-dd) | SELECT (TO_DATE(SUBSTRING('${taskid}', 1, 8), 'YYYYMMDD') - INTERVAL '2 days')::DATE |
| taskidyyyymm | 数据日期的年月(YYYYMM) | SELECT SUBSTRING('${taskid}' FROM 1 FOR 6) |
| tenYearBeforeThisday | 10年前的当天(yyyymmdd) | SELECT to_char(CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '10 years', 'YYYYMMDD') AS formatted_date; |
| ten_Year_Before_Thisday | 10年前的当天(yyyy-mm-dd) | SELECT to_char(CAST('${taskid?substring(0,8)}' AS DATE) - INTERVAL '10 years', 'YYYY-MM-DD') AS formatted_date; |
| today | 今天日期yyyymmdd | SELECT REPLACE( TO_CHAR( (TO_DATE('${taskid?substring(0,8)}', 'YYYY-MM-DD') + INTERVAL '1 day')::DATE, 'YYYY-MM-DD' ), '-', '' ) |
| v2Year_of_PreMon | 前2月所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '2 months', 'YYYY'); |
| v3Year_of_PreMon | 前3月所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '3 months', 'YYYY'); |
| v4Year_of_PreMon | 前4月所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '4 months', 'YYYY'); |
| v5Year_of_PreMon | 前5月所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '5 months', 'YYYY'); |
| v6Year_of_PreMon | 前6月所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '6 months', 'YYYY'); |
| v7Year_of_PreMon | 前7月所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '7 months', 'YYYY'); |
| v8Year_of_PreMon | 前8月所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '8 months', 'YYYY'); |
| v9Year_of_PreMon | 前9月所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '9 months', 'YYYY'); |
| v10Year_of_PreMon | 前10月所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '10 months', 'YYYY'); |
| v11Year_of_PreMon | 前11月所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '11 months', 'YYYY'); |
| v12Year_of_PreMon | 前12月所在年(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '12 months', 'YYYY'); |
| vYear_of_PreMon | 上个月的年份(yyyy) | SELECT to_char(to_date(substring('${taskid}', 1, 8), 'YYYYMMDD') - interval '1 month', 'YYYY'); |
| v_LastDate_M | 前一天日期（截取到年月） | SELECT CONCAT(SUBSTRING(CAST(DATE_TRUNC('day', ('${taskid?substring(0,8)}'::date - INTERVAL '1 DAY')) AS TEXT), 1, 4), SUBSTRING(CAST(DATE_TRUNC('day', ('${taskid?substring(0,8)}'::date - INTERVAL '1 DAY')) AS TEXT), 6, 2)); |
| vpre31lastmonthlastDate | 上月最后一天 然后再减去31天 | SELECT (to_date(CONCAT(SUBSTRING('${taskid}' FROM 1 FOR 4), '-', SUBSTRING('${taskid}' FROM 5 FOR 2), '-01'), 'YYYY-MM-DD') - INTERVAL '32 DAY')::DATE AS calculated_date; |
| weeks | 本年周数 | SELECT EXTRACT(WEEK FROM TO_DATE(SUBSTRING('${taskid}01', 1, 4) |
| xjd_firstday | 下季度第一天 | SELECT CASE WHEN SUBSTRING('${taskid}', 5, 2) IN ('01', '02', '03') THEN CONCAT(SUBSTRING('${taskid}', 1, 4), '-04-01') WHEN SUBSTRING('${taskid}', 5, 2) IN ('04', '05', '06') THEN CONCAT(SUBSTRING('${taskid}', 1, 4), '-07-01') WHEN SUBSTRING('${taskid}', 5, 2) IN ('07', '08', '09') THEN CONCAT(SUBSTRING('${taskid}', 1, 4), '-10-01') WHEN SUBSTRING('${taskid}', 5, 2) IN ('10', '11', '12') THEN CONCAT(CAST(SUBSTRING('${taskid}', 1, 4) AS INTEGER) + 1, '-01-01')END AS var_val; |
| year | 当前日期的年 | ${taskid?substring(0,4)} |
| yearlastday | 当年最后一天(yyyy-mm-dd) | SELECT (date_trunc('MONTH', to_date(concat(substr(${'${taskid}'}, 1, 4), '-12-01'), 'YYYY-MM-DD')) + INTERVAL '1 MONTH' - INTERVAL '1 day')::DATE AS last_day_of_december; |
| ytask_day | 日批次对应上年同期日 | SELECT to_char((to_date('${taskid?substring(0,8)}', 'YYYYMMDD') - INTERVAL '1 year')::date, 'YYYYMMDD') AS new_date; |
| ytask_mon | 上年同月 | SELECT substr( to_char( (to_date( concat( substr('${taskid}', 1, 4), '-', substr('${taskid}', 5, 2), '-', substr('${taskid}', 7, 2) ), 'YYYY-MM-DD' ) - INTERVAL '1 year'), 'YYYYMM' ), 1, 6 ) AS formatted_date |
| ytaskid | 今年（yyyy） | ${taskid?calDate(+0,'Y','yyyy')} |
| yyyy | yyyy | ${taskid?calDate(+0,'Y','yyyy')} |
